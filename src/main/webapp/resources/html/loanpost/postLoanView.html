
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>服务管理&gt;贷后管理&gt;贷后查询列表&gt;查看</title>
<link href="../../css/app.css" type="text/css" rel="stylesheet" />
<link href="../../css/zx-all.css" rel="stylesheet" type="text/css" />
<script language="Javascript" src="../../js/zx-all.js"> </script>

<style type="text/css">
.textright {
	text-align: right;
}
.textleft {
	text-align: left;
}
/*input_tb css*/
.input_tb_new {
	/*border:1px solid #dfdfdf;*/
	width: 100%;
	margin-bottom: 10px;
}
.input_tb_new a {
	color: #056aff;
	text-decoration: none;
	font-weight: normal;
}
.input_tb_new td {
	height: 35px;
	line-height: 25px;
	/*border-bottom:1px dashed #d5d5d5;*/
	padding-top: 3px;
}
.input_tb_new .tr_title td {
	background-color: #f5f8ff;
	padding-left: 16px;
	font-weight: bold;
	height: 30px;
	line-height: 30px;
	/*border-bottom:1px solid #dfdfdf;*/
}
.input_tb_new .tr_last td {
	border-bottom: 0;
}
.input_tb_new .title {
	text-align: right;
}
.input_tb_new .subtitle {
	text-align: left;
	background-color: #d2e1fd;
	border-top: 1px solid #fff;
}
.input_tb_new .tr_btn_input td {
	background-color: #fbfbfb;
}
.title_tb {
	background-color: #f5f8ff;
	padding-left: 16px;
	font-weight: bold;
	height: 30px;
	line-height: 30px;
	/*border:1px solid #dfdfdf;*/
	border-bottom:0;
}
.title_tb .title_txt{
float:left;
}
.title_tb .title_btn{
float:right;
margin-top:2px;
font-weight:normal;
}
.input_tb_new td {
    /*border-bottom: 1px dashed #D5D5D5;*/
	height: 35px;
	line-height: 25px;
	padding-top: 3px;
}
.data_tb td {
	height: 30px;
	line-height: 24px;
	padding-left: 10px;
	border-bottom: 1px dashed #e3e4e6;
	text-align: left;
}
#huankuan {
	text-align: left;
}
input{
 border:0px;
}
</style>
</head>
<body>
	<div class="pop-center overflow-au">
		<!--查询条件  begin-->
		<table width="100%" border="0" cellspacing="0" cellpadding="0">
			<tr valign="bottom" id='trtab1'>
				<td class="tabbody1" onclick="changeTab('reminder', this);" tabname='mytab'
					style="width: 20%"><div align="center">催缴单</div></td>
				<td class="tabbody2" onclick="changeTab('reminderList', this);" tabname='mytab'
					style="width: 20%"><div align="center">催缴单列表</div></td>
				<td class="tabbody2" onclick="changeTab('processingoftracking', this);" tabname='mytab'
					style="width: 20%"><div align="center">跟踪处理结果</div></td>
				<td class="tabbody2" onclick="changeTab('repaymensituation', this);" tabname='mytab'
					style="width: 20%"><div align="center">还款情况</div></td>
				<td class="tabbody2" onclick="changeTab('repaymenthistory', this);" tabname='mytab'
					style="width: 20%"><div align="center">还款历史</div></td>
			</tr>
		</table>
		<div id="tabs" class="pop-center overflow-au" style="top: 30px;">
			<!--------------------------------------------------------------------催缴单 begin----------------------------------------------------------------  -->
			<div id="reminder" class="pop-formDiv clearfix" style="margin: 5px; margin-top: 30px;">
					<div class="float-l">
						<div class="pop-form-title" style="font-weight:bold;">客户名称:</div>
						<div class="pop-form-item">
							<input type="text" id="dunning_name" readonly="readonly" />
						</div>
					</div>
					<div class="float-l" style="left: 50px;">
						<div class="pop-form-title" style="font-weight:bold;">联系电话:</div>
						<div class="pop-form-item">
							<input type="text" id="dunning_tel"  readonly="readonly" />
						</div>
					</div>
					<div class="float-l">
						<div class="pop-form-title" style="font-weight:bold;">贷款种类:</div>
						<div class="pop-form-item">
							<input type="text" id="cre_loan_type_name" readonly="readonly" />
						</div>
					</div>
					<div class="float-l clearboth">
						<div class="pop-form-title" style="font-weight:bold;">合同编号:</div>
						<div class="pop-form-item">
							<input type="text" id="protocol_code" readonly="readonly" />
						</div>
					</div>
					<div class="float-l">
						<div class="pop-form-title" style="font-weight:bold;">签约日期:</div>
						<div class="pop-form-item">
							<input type="text" id="protocol_creat_date" readonly="readonly" />
						</div>
					</div>
					<div class="float-l">
						<div class="pop-form-title" style="font-weight:bold;">合同金额:</div>
						<div class="pop-form-item">
							<input type="text" id="protocol_amount" readonly="readonly" style="width: 120px;"/>元
						</div>
					</div>
					<div class="float-l">
						<div class="pop-form-title" style="font-weight:bold;">违约日期:</div>
						<div class="pop-form-item">
							<input type="text" id="default_date" 
								maxlength="50" readonly="readonly" />
						</div>
					</div>
					<div class="float-l">
						<div class="pop-form-title" style="font-weight:bold;">已还期数:</div>
						<div class="pop-form-item">
							<input type="text" id="repay_period" 
								maxlength="50" readonly="readonly" />
						</div>
					</div>
					<div class="float-l">
						<div class="pop-form-title" style="font-weight:bold;">期数:</div>
						<div class="pop-form-item">
							<input type="text" id="deadline" 
								maxlength="50" readonly="readonly" />
						</div>
					</div>
					<div class="float-l clearboth" >
						<div class="pop-form-title" style="font-weight:bold;">剩余债权:</div>
						<div class="pop-form-item">
							<input type="text" id="un_matching_creditor"  readonly="readonly" />
						</div>
					</div>
					<div class="float-l">
						<div class="pop-form-title" style="font-weight:bold;">逾期天数:</div>
						<div class="pop-form-item">
							<input type="text" id="overdue_day" readonly="readonly" style="width: 120px;"/>天
						</div>
					</div>
					<div class="float-l">
						<div class="pop-form-title" style="font-weight:bold;">每日滞纳金额:</div>
						<div class="pop-form-item">
							<input type="text" id="liquidated_damages" readonly="readonly" style="width: 120px;"/>元
						</div>
					</div>
					<div class="float-l">
						<div class="pop-form-title" style="font-weight:bold;">违约金额:</div>
						<div class="pop-form-item">
							<input type="text" id="default_amount" 
								maxlength="50" readonly="readonly" style="width: 120px;" />元
						</div>
					</div>
					<div class="float-l">
						<div class="pop-form-title" style="font-weight:bold;">客户经理:</div>
						<div class="pop-form-item">
							<input type="text" id="salesman_name" 
								maxlength="50" readonly="readonly" />
						</div>
					</div>
					<div class="float-l">
						<div class="pop-form-title" style="font-weight:bold;">团队经理:</div>
						<div class="pop-form-item">
							<input type="text" id="team_manager_name" 
								maxlength="50" readonly="readonly" />
						</div>
					</div>
					<div class="float-l clearboth">
						<div class="pop-form-title" style="font-weight:bold;">还款银行:</div>
						<div class="pop-form-item">
							<input type="text" id="refund_bank" 
								maxlength="50" readonly="readonly" />
						</div>
					</div>
					<div class="float-l">
						<div class="pop-form-title" style="font-weight:bold;">还款账号:</div>
						<div class="pop-form-item">
							<input type="text" id="refund_number" 
								maxlength="70" readonly="readonly" style="width: 130px;" />
						</div>
					</div>
					<div class="float-l">
						<div class="pop-form-title" style="font-weight:bold;">抵押情况:</div>
						<div class="pop-form-item">
							<input type="text" id="mortgrage_name"/>
						</div>
					</div>
					<div class="float-l clearboth">
						<div class="pop-form-title" style="font-weight:bold;">备注:</div>
						<textarea id="dunning_remark" name="dunning_remark" rows="" cols="" style="width: 700px;height: 80px;resize:none;" readonly="readonly"></textarea>
					</div>
			</div>
			<!-- -----------------------------------------------------------------催缴单 end------------------------------------------------------------------ -->
			<!-- -----------------------------------------------------------------催缴单列表 begin------------------------------------------------------------------ -->
			<div id="reminderList" class="pop-formDiv clearfix" style="margin: 5px; margin-top: 5px; display: none;">		
				<div class="center-content clearboth" style="min-width: 500px;margin-top: 35px;">
					<div class="center-txt" style="margin-bottom: 10px;">
						<div id="grid_reminderList"></div>
					</div>
				</div>
			</div>
			<!-- -----------------------------------------------------------------催缴单列表 end------------------------------------------------------------------ -->
			<!--------------------------------------------------------------------跟踪处理结果 begin----------------------------------------------------------------  -->
			<div id="processingoftracking" class="pop-formDiv clearfix" style="margin: 5px; margin-top: 5px; display: none;">
				<div class="center-title3 position-re">
					催缴跟踪
					<div name="suofang" class="show-hide l-icon-hide"></div>
				</div>
			</div>
			<!-- -----------------------------------------------------------------跟中处理结果 end------------------------------------------------------------------ -->
			<!-- ------------------------------------------------------------------还款情况 begin------------------------------------------------------------------ -->
			<div id="repaymensituation" class="pop-formDiv clearfix" style="margin: 5px; margin-top: 5px; display: none;">		
						<div class="float-l">
							每期还款情况:
						</div>
						<div class="float-l">
							<div class="pop-form-title">本金:</div>
							<div class="pop-form-item">
								<input type="text" id="org_repay_principal"maxlength="50" readonly="readonly" style="width: 80px;"  class ="text0" />元
							</div>
						</div>
						<div class="float-l">
							<div class="pop-form-title">利息:</div>
							<div class="pop-form-item">
								<input type="text" id="org_repay_interest"maxlength="50" readonly="readonly" style="width: 80px;"  class ="text0" />元
							</div>
						</div>
						<div class="float-l">
							<div class="pop-form-title">总还款额:</div>
							<div class="pop-form-item">
								<input type="text" id="org_repay_total"maxlength="50" readonly="readonly" style="width: 80px;"  class ="text0" />元
							</div>
						</div>
						<div id="last" style="display: none;">
						<div class="float-l clearboth">
							&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;最后一期:
						</div>
						<div class="float-l">
							<div class="pop-form-title">本金:</div>
							<div class="pop-form-item">
								<input type="text" id="org_repay_principal1"maxlength="50" readonly="readonly" style="width: 80px;"  class ="text0" />元
							</div>
						</div>
						<div class="float-l">
							<div class="pop-form-title">利息:</div>
							<div class="pop-form-item">
								<input type="text" id="org_repay_interest1"maxlength="50" readonly="readonly" style="width: 80px;"  class ="text0" />元
							</div>
						</div>
						<div class="float-l">
							<div class="pop-form-title">总还款额:</div>
							<div class="pop-form-item">
								<input type="text" id="org_repay_total1"maxlength="50" readonly="readonly" style="width: 80px;"  class ="text0" />元
							</div>
						</div>
						<div class="float-l">
							<div class="pop-form-item">
								(<input type="text" id=""maxlength="50" readonly="readonly" value="特色贷" style="width: 60px;" class ="text0"  />)
							</div>
						</div>
						</div>
					<div class="center-content clearboth" style="min-width: 500px;margin-top: 35px;">
						<div class="center-txt" style="margin-bottom: 10px;">
							<div id="grid_sit"></div>
						</div>
					</div>
					<div id="heji">
						<div class="float-l clearboth">
							<div class="pop-form-title">合计:</div>
						</div>
						<div class="float-l">
							<div class="pop-form-item">
								已还本金:<input type="text" id="repay_principal_sum" readonly="readonly" style="width: 50px;"  class ="text0" />元
							</div>
						</div>
						<div class="float-l">
							
							<div class="pop-form-item"style="wight:20;">
								未还本金:<input type="text" id="un_repay_principal_sum" readonly="readonly" style="width: 50px;"  class ="text0" />元
							</div>
						</div>
						<div class="float-l">
							
							<div class="pop-form-item">
								已还利息:<input type="text" id="repay_interest_sum" readonly="readonly" style="width: 50px;"  class ="text0" />元
							</div>
						</div>
						<div class="float-l">
							
							<div class="pop-form-item">
								未还利息:<input type="text" id="un_repay_interest_sum" readonly="readonly" style="width: 50px;"  class ="text0" />元
							</div>
						</div>
						<div class="float-l">
							<div class="pop-form-item">
								滞纳金:<input type="text" id="cur_late_fee_sum" readonly="readonly" style="width: 50px;"  class ="text0" />元
							</div>
						</div>
					</div>
				</div>
			<!-- ------------------------------------------------------------------还款情况 end------------------------------------------------------------------ -->
			<!-- ------------------------------------------------------------------还款历史 begin------------------------------------------------------------------ -->
			<div id="repaymenthistory" class="pop-formDiv clearfix" style="margin: 5px; margin-top: 5px; display: none;">		
				<div class="center-content clearboth" style="min-width: 500px;margin-top: 35px;">
					<div class="center-txt" style="margin-bottom: 10px;">
						<div id="grid-top"></div>
					</div>
				</div>
			</div>
		</div>
	</div>
	<!-- ------------------------------------------------------------------还款历史 end------------------------------------------------------------------ -->
	<!-- 提交功能按钮区 -->
	<div class="pop-footer5 clearboth" style="bottom: 1px;">
		<input
			id="cancelBtnId" class="btn-cancel"
			onmouseover="this.className='btn-cancel-over'"
			onmouseout="this.className='btn-cancel'"
			onmousedown="this.className='btn-cancel-down'" type="button"
			onclick="closePage();" />
	</div>
	<script type="text/javascript">
	var wms_post_dunning_head_id=$.query.get('wms_post_dunning_head_id');
	var wms_cre_credit_head_id=$.query.get('wms_cre_credit_head_id');
	var wms_fina_cre_pay_id =$.query.get('wms_fina_cre_pay_id');
	var wms_cre_appro_borrow_protocol_id=$.query.get('wms_cre_appro_borrow_protocol_id');
	var homekey=$.query.get('homekey');//判断是催缴审核还是上门催缴
	var grid_top;
	var flag=1;//仅作是否增加跟踪记录标识
	$(function(){
		    //催缴单据ID获取审核信息
			$.getJSON(globalUtil.getTimestampUrl('/loanpost/wmspostdunningheadinfobypkk.do'),
			{
				"wms_post_dunning_head_id" : wms_post_dunning_head_id,
			},
			function(json) {
				//加载催缴单信息
				globalUtil.setFormVal("reminder", json);
				//加载贷后专员和结果信息
				globalUtil.setFormVal("processingoftracking", json);
				
				});
		//催缴单列表
		init_reminderList_grid();
		//还款情况    
		init_sit_grid();
		//还款历史
		init_top_grid();
		getInfodetailed();
		sumVal();
		getinfoforphone();
	
	});
	function getInfodetailed(){
		//根据催缴单主键获取催缴跟踪明细
		$.getJSON(globalUtil.getTimestampUrl("/loanpost/wmspostdunningprocessingoftracking.do"),
			{
				"wms_cre_credit_head_id" : wms_cre_credit_head_id,
			},function(data){
				if(data !=null && data!=""){
					var idx = "0";
					$.each(data, function(i, n) {
						var htmlval="";
						htmlval += "<div class='center-content clearboth' style='min-width: 500px;margin-top: 10px;'>";
						htmlval += "<div class='center-title'>催缴单编号：" + n.post_dunning_cj_code + "</div>";
						htmlval += "<div class='center-txt' style='margin-bottom: 10px;'>";
						htmlval += "<div id='grid_process"+i+"' ></div>";
						htmlval += "</div>";
						htmlval += "</div>";
						htmlval += "</div>";
						$("#processingoftracking").append(htmlval);
						init_process_grid(n.processIngo, i);
						
					});
					
				} 
			});
	}
	
	//滑动块
	function upAndDownToggle(selector) {
		//通过判断按钮btn有没有active这个class名判断是否已经点击过
	    if($(selector).hasClass("l-icon-show")){
		    //如果有了active，假设已经点击过了
		    //执行你的代码
		    //把active去掉
		    $(selector).parent().siblings().slideDown(500);
		    $(selector).attr('class','show-hide l-icon-hide');
	    }else{
		    //没有active，假设还没有点击过
		    //执行你的代码
	    	$(selector).parent().siblings().slideUp(500);
        	$(selector).attr('class','show-hide l-icon-show');	
	    }
	}
	
	//催缴单列表
	function init_reminderList_grid(){
		var columns = [{
			display: '催缴单编号',
	        name: 'post_dunning_cj_code',
	        resizable: false,
	        width: 21,
	        minWidth: 250,
	      	//添加超链接的东西
            render: function (rowdata, rowindex, value) { 
            	return value;
    		}
	    }, {
	        display: '预期缴回金额（元）',
	        name: 'expect_payment_amount',
	        resizable: false,
	        width: 21,
	        minWidth: 150	
	    }, {
	        display: '实际缴回金额（元）',
	        name: 'reality_payment_amount',
	        resizable: false,
	        width: 21,
	        minWidth: 150
	    }, {
	        display: '提交日期',
	        name: 'post_dunning_commissioner_time',
	        resizable: false,
	        width: 21,
	        minWidth: 150
	    },{
	        display: '催缴状态',
	        name: 'dunning_status',
	        resizable: false,
	        width: 21,
	        minWidth: 180
	    }];
		
		grid_sit = $("#grid_reminderList").ligerGrid({
	    	columns: columns,
	    	url: global_param.context_name + '/loanpost/getReminderListBychid.do?wms_cre_credit_head_id='+wms_cre_credit_head_id,
    		rownumbers: true,
    		allowUnSelectRow: true,
    		usePager: false,
    		width: '100%',
    		height: 300,
    		heightDiff: -4
	    });
	}
	
	//催缴跟踪
	function init_process_grid(json, idx){
		var columns = [{
	        display: '催缴日期',
	        name: 'dunning_datetime_str',
	        resizable: false,
	        width: 21,
	        minWidth: 250
	    },{
	        display: '贷后专员',
	        name: 'dunning_name',
	        resizable: false,
	        width: 21,
	        minWidth: 250
	    },{
	        display: '催缴详情',
	        name: 'dunning_remark',
	        resizable: false,
	        width: 21,
	        minWidth: 350
	    }];
		
		grid_sit = $("#grid_process" + idx).ligerGrid({
	    	columns: columns,
	    	data:json,
    		rownumbers: true,
    		allowUnSelectRow: true,
    		usePager: false,
    		width: '100%',
    		height: 100,
    		heightDiff: -4
	    });
	}
	
	//还款情况
	function init_sit_grid(){
		var columns = [{
			display: '期数',
	        name: 'repay_no',
	        resizable: false,
	        width: 21,
	        minWidth: 120,
	        //添加超链接的东西
            render: function (rowdata, rowindex, value) { 
            	return "第"+changeCurrency(value)+"期";
    		}
	    }, {
	        display: '已还本金',
	        name: 'repay_principal',
	        resizable: false,
	        width: 21,
	        minWidth: 150	
	    }, {
	        display: '未还本金（元）',
	        name: 'un_repay_principal',
	        resizable: false,
	        width: 21,
	        minWidth: 150
	    }, {
	        display: '已还利息（元）',
	        name: 'repay_interest',
	        resizable: false,
	        width: 21,
	        minWidth: 150
	    },{
	        display: '未还利息（元）',
	        name: 'un_repay_interest',
	        resizable: false,
	        width: 21,
	        minWidth: 150
	    },{
	        display: '滞纳金（元）',
	        name: 'cur_late_fee',
	        resizable: false,
	        width: 21,
	        minWidth: 150
	    }];
		
		grid_sit = $("#grid_sit").ligerGrid({
	    	columns: columns,
	    	url: global_param.context_name + '/loanfina/getinfobyhk.do?wms_cre_credit_head_id='+wms_cre_credit_head_id,
    		rownumbers: true,
    		allowUnSelectRow: true,
    		usePager: false,
    		width: '100%',
    		height: 260,
    		heightDiff: -4
	    });
	}
	
	//还款历史
	function init_top_grid(){
		var columns = [{
			display: '还款还款流水',
	        name: 'repayment_history_code',
	        resizable: false,
	        width: 21,
	        minWidth: 140
	    }, {
	        display: '还款日期',
	        name: 'repayment_date_str',
	        resizable: false,
	        width: 21,
	        minWidth: 110	
	    }, {
	        display: '还款总额（元）',
	        name: 'this_total_repayment',
	        resizable: false,
	        width: 21,
	        minWidth: 110
	    }, {
	        display: '其中，本金（元）',
	        name: 'this_principal',
	        resizable: false,
	        width: 21,
	        minWidth: 110
	    },{
	        display: '利息（元）',
	        name: 'this_interest',
	        resizable: false,
	        width: 21,
	        minWidth: 110
	    },{
	        display: '滞纳金（元）',
	        name: 'this_late_fees',
	        resizable: false,
	        width: 21,
	        minWidth: 110
	    },{
        	display: '减免额（元）',
            name: 'this_amount_relief',
            width: 100,
            minWidth: 110
        },{
        	display: '操作人',
            name: 'create_user_name',
            width: 100,
            minWidth: 100
	        }];
		
	    grid_top = $("#grid-top").ligerGrid({
	    	columns: columns,
	    	url: global_param.context_name + '/loanfina/wmsfinacrerepaymenthistoryinfobyhk.do?wms_cre_credit_head_id='+wms_cre_credit_head_id,
    		rownumbers: true,
    		allowUnSelectRow: true,
    		usePager: false,
    		width: '100%',
    		height: 300,
    		heightDiff: -4
	    });
	}
	//弹出错误提示框
	function errorMsg(msg,ele){
		globalUtil.addMask('1');
		var obj = $.ligerDialog.error(msg, null, null);
		obj.options.onHiddenOrClose = function() {
			$(ele).val('');
			$(ele).focus();
			globalUtil.delMask('1');
	    };
	}
 	//关闭页面
    function closePage(){
    	window.parent.search();
    	window.parent.dialog.hide();
    }
    //页面切换
    function changeTab(param, selector) {
		$(selector).removeClass("tabbody2").addClass("tabbody1")
			.siblings().removeClass("tabbody1").addClass("tabbody2");
		$("#" + param).show();
		$("#tabs").children().not($("#" + param)).hide();
	}
    //获取合每期还款金额和最后一起还款金额
	function getinfoforphone(){
		$.getJSON(globalUtil.getTimestampUrl('/loanfina/getinfoforphone.do'),
				{
					"wms_cre_credit_head_id" : wms_cre_credit_head_id
				},function(json) {
					if(json!=null&&json!=""){//特色贷  id值为284
						for(var i=0;i<json.Rows.length;i++){
							if(i>0&&json.Rows[i].cre_loan_type==284){
								$("#last").css("display","");
								$("#org_repay_principal1").val(json.Rows[i].org_repay_principal);
								$("#org_repay_interest1").val(json.Rows[i].org_repay_interest);
								$("#org_repay_total1").val(json.Rows[i].org_repay_total);
							}else if(i==0){
								$("#org_repay_principal").val(json.Rows[i].org_repay_principal);
								$("#org_repay_interest").val(json.Rows[i].org_repay_interest);
								$("#org_repay_total").val(json.Rows[i].org_repay_total);
							}
							
						}
					}
				});
	}
	//计算总和
	function sumVal(){
		 //根据还款信息表主键和单据主键获取相关信息
		$.getJSON(globalUtil.getTimestampUrl('/loanfina/getSumval.do'),
		{
			"wms_cre_credit_head_id" : wms_cre_credit_head_id
		},
		function(json) {	
			globalUtil.setFormVal("heji", json);
			});
	}
	
	//数字大小写转换
	 function changeCurrency(currencyDigits) {  
			var MAXIMUM_NUMBER = 99999999999.99;   
			var CN_ZERO = "零";  
			var CN_ONE = "一";  
			var CN_TWO = "二";  
			var CN_THREE = "三";  
			var CN_FOUR = "四";  
			var CN_FIVE = "五";  
			var CN_SIX = "六";  
			var CN_SEVEN = "七";  
			var CN_EIGHT = "八";  
			var CN_NINE = "九";  
			var CN_TEN = "十";  
			var CN_HUNDRED = "百";  
			var CN_THOUSAND = "千";  
			var CN_TEN_THOUSAND = "万";  
			var CN_HUNDRED_MILLION = "亿";  
			var CN_SYMBOL = "";  
			var CN_DOLLAR = "";  
			var CN_TEN_CENT = "";  
			var CN_CENT = "";  
			var CN_INTEGER = "";  
			    
			var integral;   
			var decimal; 
			var outputCharacters; 
			var parts;  
			var digits, radices, bigRadices, decimals;  
			var zeroCount;  
			var i, p, d;  
			var quotient, modulus;  
			  
			currencyDigits = currencyDigits.toString();   
			  
			currencyDigits = currencyDigits.replace(/,/g, ""); 
			currencyDigits = currencyDigits.replace(/^0+/, ""); 
			
			if (Number(currencyDigits) > MAXIMUM_NUMBER) {  
			  globalUtil.errorMsg(globalErrorMsg['100404']);  
			  return "";  
			}		
			parts = currencyDigits.split(".");  
			if (parts.length > 1) {  
			  integral = parts[0];  
			  decimal = parts[1];  
			  decimal = decimal.substr(0, 2);  
			}  
			else {  
			  integral = parts[0];  
			  decimal = "";  
			}  
			digits = new Array(CN_ZERO, CN_ONE, CN_TWO, CN_THREE, CN_FOUR, CN_FIVE, CN_SIX, CN_SEVEN, CN_EIGHT, CN_NINE);  
			radices = new Array("", CN_TEN, CN_HUNDRED, CN_THOUSAND);  
			bigRadices = new Array("", CN_TEN_THOUSAND, CN_HUNDRED_MILLION);  
			decimals = new Array(CN_TEN_CENT, CN_CENT);  
			outputCharacters = "";  
			if (Number(integral) > 0) {  
			  zeroCount = 0;  
			  for (i = 0; i < integral.length; i++) {  
			   p = integral.length - i - 1;  
			   d = integral.substr(i, 1);  
			   quotient = p / 4;  
			   modulus = p % 4;  
			   if (d == "0") {  
			    zeroCount++;  
			   }  
			   else {  
			    if (zeroCount > 0)  
			    {  
			     outputCharacters += digits[0];  
			    }  
			    zeroCount = 0;  
			    outputCharacters += digits[Number(d)] + radices[modulus];  
			  }  
			   if (modulus == 0 && zeroCount < 4) {  
			    outputCharacters += bigRadices[quotient];  
			  }  
			  }  
			  outputCharacters += CN_DOLLAR;  
			}  
			if (decimal != "") {  
			  for (i = 0; i < decimal.length; i++) {  
			   d = decimal.substr(i, 1);  
			   if (d != "0") {  
			    outputCharacters += digits[Number(d)] + decimals[i];  
			   }  
			  }  
			}  
			if (outputCharacters == "") {  
			  outputCharacters = CN_ZERO + CN_DOLLAR;  
			}  
			if (decimal == "") {  
			  outputCharacters += CN_INTEGER;  
			}  
			outputCharacters = CN_SYMBOL + outputCharacters;  
			return outputCharacters;  
		}
		
</script>
</body>
</html>