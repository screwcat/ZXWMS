<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<title>佣金一般规则(新)</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link href="../../css/app.css" type="text/css" rel="stylesheet" />
<link href="../../css/zx-all.css" rel="stylesheet" type="text/css" />
<link href="../../css/button.css" rel="stylesheet" type="text/css" />
<link href="../../css/icon.css" rel="stylesheet" type="text/css" />
<script src="../../js/zx-all.js" type="text/javascript"></script>
<style type="text/css">
#lcsqxxtable td {
    padding: 7px;
}
.trSelected{
    background: #f7f6cf; 
}
.newCopy{
    border-top: 1px solid red;
    border-right: 2px solid red;
    border-bottom: 1px solid red;
    border-left: 2px solid red;
}
</style>
</head>
<body>
    <div style="margin-bottom: 1px">
        <div class="tab_titleT">
            <table width="100%" border="0" cellspacing="0" cellpadding="0">
                <tr valign="bottom">
                    <td class="tabbody1" id="tabbody1" onclick="changeTab('khjl');">
                        <div align="center" id="khtabdiv" class="tab_step tab_step101">
                                                                            客户经理佣金规则
                        </div>
                    </td>
                    <td class="tabbody2" id="tabbody2" onclick="changeTab('jxjl');">
                        <div align="center" id="jxtabdiv" class="tab_step tab_step202">
                                                                            见习团队经理佣金规则
                        </div>
                    </td>
                    <td class="tabbody2" id="tabbody3" onclick="changeTab('tdjl');">
                        <div align="center" id="tdtabdiv" class="tab_step tab_step302">
                                                                            团队经理佣金规则
                        </div>
                    </td>
                </tr>
            </table>
        </div>
        <div class="pop-center overflow-au" style="top: 30px">
            <div id="khjl" class="center-content" style="min-width: 550px; height: auto">
                <div>
                    <div style="float: left; margin-left:60px;margin-top: 5px">
                        <a href="#" onclick="copyNewkhToTD()" class="btn">复制到团队</a>
                        <a href="#" onclick="copyNewkhToJX()" class="btn">复制到见习</a>
                        <a href="#" onclick="copyNewkh()" class="btn">复制</a>
                        <a href="#" onclick="addNewkh()" class="btn">新增</a>
                    </div>
                    <div id="lcsqxxdiv" class="center-txt clearfix" style="margin-bottom: 5px; padding: 5px; border: 1px solid #BFBFBF; min-height:650px;">
                        <div class="float-l commonstyle clearboth">
                            <table id="lcsqxxtablekh" border="1"
                                style="text-align: center; margin-left: 55px; margin-bottom: 5px; margin-top: 3px">
                                <tr id="lcsqxxtrkh" style="background-color: #676b73; color: white">
                                    <td width="120px" height="35px" class="title"></td>
                                    <td width="150px" height="35px" class="title">归属公司</td>
                                    <td width="160px" height="35px" class="title">职务</td>
                                    <td width="150px" height="35px" class="title">员工状态</td>
                                    <td width="320px" height="35px" class="title">产品</td>
                                    <td width="150px" height="35px" class="title">规则状态</td>
                                    <td width="130px" height="35px" class="title">创建时间</td>
                                    <td width="130px" height="35px" class="title">启用时间</td>
                                    <td width="130px" height="35px" class="title">禁用时间</td>
                                    <td width="106px" height="35px" class="title">操作</td>
                                </tr>
                            </table>
                        </div>
                    </div>
                </div>
                <!-- 分页 -->
                <div class="pageDiv right">
                    <span id="page">1/共1页</span>
                    <a href="javascript:void(0)" class="btnPage" onclick="getInfo(params,'firstPage')">首页</a>
                    <a href="javascript:void(0)" id="frontPage" class="btnPage" style="width:20px;" onclick="getInfo(params,'frontPage')">
                        <i class="icon arrowL-ico3"></i>
                    </a>
                    <a href="javascript:void(0)" id="nextPage" class="btnPage" style="width:20px;" onclick="getInfo(params,'nextPage')">
                        <i class="icon arrowR-ico3"></i>
                    </a>
                    <a href="javascript:void(0)" class="btnPage" onclick="getInfo(params,'lastPage')">尾页</a>
                </div>
            </div>
            <div id="jxjl" class="center-content" style="display: none;min-width: 550px; height: auto">
                <div>
                    <div style="float: left; margin-left:60px;margin-top: 5px">
                        <a href="#" onclick="copyNewjx()" class="btn">复制</a>
                        <a href="#" onclick="addNewjx()" class="btn">新增</a>
                    </div>
                    <div id="lcsqxxdiv" class="center-txt clearfix" 
                       style="margin-bottom: 5px; padding: 5px; border: 1px solid #BFBFBF; min-height:650px;">
                        <div class="float-l commonstyle clearboth">
                            <table id="lcsqxxtablejx" border="1"
                                style="text-align: center; margin-left: 55px; margin-bottom: 5px; margin-top: 3px">
                                <tr id="lcsqxxtrjx" style="background-color: #676b73; color: white">
                                    <td width="120px" height="35px" class="title"></td>
                                    <td width="150px" height="35px" class="title">归属公司</td>
                                    <td width="150px" height="35px" class="title">职务</td>
                                    <td width="320px" height="35px" class="title">产品</td>
                                    <td width="150px" height="35px" class="title">规则状态</td>
                                    <td width="130px" height="35px" class="title">创建时间</td>
                                    <td width="130px" height="35px" class="title">启用时间</td>
                                    <td width="130px" height="35px" class="title">禁用时间</td>
                                    <td width="106px" height="35px" class="title">操作</td>
                                </tr>
                            </table>
                        </div>
                    </div>
                </div>
                <!-- 分页 -->
                <div class="pageDiv right">
                    <span id="pagejx">1/共1页</span>
                    <a href="javascript:void(0)" class="btnPage" onclick="getInfo(paramsjx,'firstPage')">首页</a>
                    <a href="javascript:void(0)" id="frontPagejx" class="btnPage" style="width:20px;" onclick="getInfo(paramsjx,'frontPage')"><i class="icon arrowL-ico3"></i></a>
                    <a href="javascript:void(0)" id="nextPagejx" class="btnPage" style="width:20px;" onclick="getInfo(paramsjx,'nextPage')"><i class="icon arrowR-ico3"></i></a>
                    <a href="javascript:void(0)" class="btnPage" onclick="getInfo(paramsjx,'lastPage')">尾页</a>
                </div>
            </div>
            <div id="tdjl" class="center-content" style="display: none;min-width: 550px; height: auto">
                <div>
                    <div style="float: left; margin-left:60px;margin-top: 5px">
                        <a href="#" onclick="copyNewtd()" class="btn">复制</a>
                        <a href="#" onclick="addNewtd()" class="btn">新增</a>
                    </div>
                    <div id="lcsqxxdiv" class="center-txt clearfix" style="margin-bottom: 5px; padding: 5px; border: 1px solid #BFBFBF; min-height:650px;">
                        <div class="float-l commonstyle clearboth">
                            <table id="lcsqxxtabletd" border="1"
                                style="text-align: center; margin-left: 55px; margin-bottom: 5px; margin-top: 3px">
                                <tr id="lcsqxxtrtd" style="background-color: #676b73; color: white">
                                    <td width="120px" height="35px" class="title"></td>
                                    <td width="150px" height="35px" class="title">归属公司</td>
                                    <td width="150px" height="35px" class="title">职务</td>
                                    <td width="320px" height="35px" class="title">产品</td>
                                    <td width="150px" height="35px" class="title">规则状态</td>
                                    <td width="130px" height="35px" class="title">创建时间</td>
                                    <td width="130px" height="35px" class="title">启用时间</td>
                                    <td width="130px" height="35px" class="title">禁用时间</td>
                                    <td width="106px" height="35px" class="title">操作</td>
                                </tr>
                            </table>
                        </div>
                    </div>
                </div>
                <!-- 分页 -->
                <div class="pageDiv right">
					<span id="pagetd">1/共1页</span>
					<a href="javascript:void(0)" class="btnPage" onclick="getInfo(paramstd,'firstPage')">首页</a>
					<a href="javascript:void(0)" id="frontPagetd" class="btnPage" style="width:20px;" onclick="getInfo(paramstd,'frontPage')">
					   <i class="icon arrowL-ico3"></i>
					</a>
					<a href="javascript:void(0)" id="nextPagetd" class="btnPage" style="width:20px;" onclick="getInfo(paramstd,'nextPage')">
					   <i class="icon arrowR-ico3"></i>
					</a>
					<a href="javascript:void(0)" class="btnPage" onclick="getInfo(paramstd,'lastPage')">尾页</a>
                </div>
            </div>
        </div>
    </div>
    <table id="cloneModelkh" border="1" style="text-align: center; margin-left: 55px; margin-bottom: 5px; margin-top: 3px">
        <tr class="noshow" style="height:35px">
            <td>
                <a href="javascript:" onclick="showOrhide(this, 'hide');">详情</a>
            </td>
            <!-- 归属公司 -->
            <td>
                <select name="belong_company" onchange="changeCompany(this)">
                </select>
            </td>
            <td>
                <input type="hidden" name="wms_inve_commission_general_rules_new_id" value="" />
                <input type="hidden" name="job_code" value="" />
                <span name="job_code_str"></span>
            </td>
            <td>
                <div style="text-align:left;margin-left:3px"></div>
                <select name="employee_state">
                   <option selected="selected" value="1">在职</option>
                   <option value="7">兼职</option>
                </select>
            </td>   
            <td>
                <input type="hidden" name="wms_inve_commission_special_rules_id" />
                <input type="hidden" name="wms_inve_pruduct_category_id" />
                <span class="category_name"></span>
                <span style="float: right">
                    <a href="#" onclick="showProducts(this)" class="selectObj">选择</a>
                </span>
            </td>
            <td>
                <input type="hidden" name="state_old_val" />
                <select name="page_rule_state" onchange="changeState(this)">
                    <option selected="selected" value="-1">请选择</option>
                    <option value="0">启用</option>
                    <option value="1">禁用</option>
                </select>
            </td>
            <td><span name="create_datetime"></span></td>
            <td><span name="start_date"></span></td>
            <td><span name="stop_date"></span></td>
            <td>
                <a href="#"onclick="save(this)">保存</a>
                <a href="#" onclick="update(this)">修改</a>
            </td>
        </tr>
        <tr style="background-color: #666666; color: white;height: 10px; display: none">
        </tr>
        <!-- tab页 -->
        <tr style="display: none">
            <td align="left" class="tabbody1 tdTab">一次性佣金</td>
            <td align="left" class="tabbody2 tdTab">月付佣金</td>
        </tr>
        <!-- 一次性佣金 -->
        <tr class="trTab1" style="background-color: #666666; color: white;height: 35px; display: none">
            <td width="150px"></td>
            <td></td>
            <td colspan="2">金额限制</td>
            <td>基础佣金系数(%)</td>
        </tr>
        <tr class="hideBegin"></tr>
        <tr class="trTab1" style="background-color: #E5FFE5; height: 35px; display: none">
            <td width="120px" rowspan="4">佣金系数</td>
            <td>上单当月给予一次性佣金</td>
            <td>
                <select name="commission_type_one">
                    <option value="1">本月新增</option>
                    <option value="-1">请选择</option>
                </select>
            </td>
            <td>
                <input type="text" name="stock_begin_one" style="width: 40px;" onblur="tranceNaN(this,'930001')" maxlength="8" />到
                <input type="text" name="stock_end_one" style="width: 40px;" onblur="tranceNaN(this,'930002')" maxlength="8" />万(含)
            </td>
            <!-- 基础佣金系数(%) -->
            <td>
                <input type="text" name="base_commission_one" style="width: 108px;" onblur="tranceNaN(this,'930003')" maxlength="8" />
                <a href="#" onclick="addRowYCX_One(this);">新增</a>
            </td>
        </tr>
        <tr class="trTab1" style="background-color: #E5FFE5; height: 35px; display: none">
            <td>上单满</td>
            <td>
                <input type="text" name="month_count" style="width: 108px;" onblur="isPositiveInteger(this,'930004')" maxlength="8" />个月
            </td>
            <td>再按照</td>
            <!-- 基础佣金系数(%) -->
            <td>
                <input type="text" name="base_commission_two" style="width: 108px;" onblur="tranceNaN(this,'930005')" maxlength="8" />
                <a href="#" onclick="addRowYCX_Two(this);">新增</a>
            </td>
        </tr>
        <tr class="trTab1 separate" style="background-color: #E5FFE5; height: 35px; display: none">
            <td>匹配异地债权给予佣金</td>
            <td colspan="2"></td>
            <!-- 基础佣金系数(%) -->
            <td>
                <input type="text" name="remote_commission_rules" style="width: 108px; margin-left: -28px" onblur="tranceNaN(this,'910082')" maxlength="8" />
            </td>
        </tr>
        <tr class="trTab1" style="background-color: #E5FFE5; height: 35px; display: none">
            <td>
                <select name="commission_type">
                    <option value="1">本季度净增</option>
                    <option value="-1">请选择</option>
                </select>
            </td>
            <td colspan="2">
                <input type="text" name="stock_begin" style="width: 40px;" onblur="tranceNaN(this,'910083')" maxlength="8" />到
                <input type="text" name="stock_end" style="width: 40px;" onblur="tranceNaN(this,'910084')" maxlength="8" />万(含)
            </td>
            <!-- 基础佣金系数(%) -->
            <td>
                <input type="text" name="base_commission" style="width: 108px;" onblur="tranceNaN(this,'910085')" maxlength="8" />
                <a href="#" onclick="addRowYCX(this);">新增</a>
            </td>
        </tr>
        <!-- 月付佣金 -->
        <tr class="trTab2" style="background-color: #666666; color: white;height: 35px; display: none">
            <td width="150px"></td>
            <td></td>
            <td>产品总存量限制</td>
            <td>基础提成系数(%)</td>
        </tr>
        <tr class="trTab2" style="background-color: #E5FFE5; height: 35px; display: none">
            <td width="120px" rowspan="1">佣金系数</td>
            <td>月付佣金</td>
            <td>
                <input type="text" name="stock_begin" style="width: 40px;" onblur="tranceNaN(this,'910086')" maxlength="8" />到
                <input type="text" name="stock_end" style="width: 40px;" onblur="tranceNaN(this,'910087')" maxlength="8" />万(含)
            </td>
            <!-- 基础提成系数(%) -->
            <td>
                <input type="text" name="base_commission" style="width: 108px;" onblur="tranceNaN(this,'910088')" maxlength="8" />
                <a href="#" onclick="addRowYF(this);">新增</a>
            </td>
        </tr>
        <tr class="hideEnd" style="background-color: #E5FFE5; height: 10px; display: none">
        </tr>
    </table>
    <table id="cloneModeltd" border="1" style="text-align: center; margin-left: 55px; margin-bottom: 5px; margin-top: 3px">
        <tr class="noshow" style="height:35px">
            <td>
                <a href="javascript:" onclick="showOrhide(this, 'hide');">详情</a>
            </td>
            <!-- 归属公司 -->
            <td>
                <select name="belong_company" onchange="changeCompany(this)">
                </select>
            </td>
            <td>
                <input type="hidden" name="wms_inve_commission_general_rules_new_id" value="" />
                <input type="hidden" name="job_code" value="" />
                <span name="job_code_str"></span>
                <!-- 见习团队经理与团队经理为在职状态:1(在职) 7:兼职 -->
                <input type="hidden" name="employee_state" value="1" />
            </td>
            <td>
                <input type="hidden" name="wms_inve_pruduct_category_id" />
                <span class="category_name"></span>
                <span style="float: right"><a href="#" onclick="showProducts(this)" class="selectObj">选择</a></span>
                <input type="hidden" name="employee_state" value="1" />
            </td>
            <td>
                <input type="hidden" name="state_old_val" />
                <select name="page_rule_state" onchange="changeState(this)">
                    <option selected="selected" value="-1">请选择</option>
                    <option value="0">启用</option>
                    <option value="1">禁用</option>
                </select>
            </td>
            <td>
                <span name="create_datetime"></span>
            </td>
            <td>
                <span name="start_date"></span>
            </td>
            <td>
                <span name="stop_date"></span>
            </td>
            <td>
                <a href="#"onclick="save(this)">保存</a>
                <a href="#" onclick="update(this)">修改</a>
            </td>
        </tr>
        <tr style="background-color: #666666; color: white;height: 10px; display: none">
        </tr>
        <!-- tab页 -->
        <tr style="display: none">
            <td align="left" class="tabbody1 tdTab">一次性佣金</td>
            <td align="left" class="tabbody2 tdTab">月付佣金</td>
            <td align="left" class="tabbody2 tdTab">团队佣金</td>
        </tr>
        <!-- 一次性佣金 -->
        <tr class="trTab1" style="background-color: #666666; color: white;height: 35px; display: none">
            <td width="150px"></td>
            <td></td>
            <td colspan="2">金额限制</td>
            <td>基础佣金系数(%)</td>
        </tr>
        <tr class="hideBegin"></tr>
        <tr class="trTab1" style="background-color: #E5FFE5; height: 35px; display: none">
            <td width="120px" rowspan="4">佣金系数</td>
            <td>上单当月给予一次性佣金</td>
            <td>
                <select name="commission_type_one">
                    <option value="1">本月新增</option>
                    <option value="-1">请选择</option>
                </select>
            </td>
            <td>
                <input type="text" name="stock_begin_one" style="width: 40px;" onblur="tranceNaN(this,'930001')" maxlength="8" />到
                <input type="text" name="stock_end_one" style="width: 40px;" onblur="tranceNaN(this,'930002')" maxlength="8" />万(含)
            </td>
            <!-- 基础佣金系数(%) -->
            <td>
                <input type="text" name="base_commission_one" style="width: 108px;" onblur="tranceNaN(this,'930003')" maxlength="8" />
                <a href="#" onclick="addRowYCX_One(this);">新增</a>
            </td>
        </tr>
        <tr class="trTab1" style="background-color: #E5FFE5; height: 35px; display: none">
            <td>上单满</td>
            <td>
                <input type="text" name="month_count" style="width: 108px;" onblur="isPositiveInteger(this,'930004')" maxlength="8" />个月
            </td>
            <td>再按照</td>
            <!-- 基础佣金系数(%) -->
            <td>
                <input type="text" name="base_commission_two" style="width: 108px;" onblur="tranceNaN(this,'930005')" maxlength="8" />
                <a href="#" onclick="addRowYCX_Two(this);">新增</a>
            </td>
        </tr>
        <tr class="trTab1 separate" style="background-color: #E5FFE5; height: 35px; display: none">
            <td>匹配异地债权给予佣金</td>
            <td colspan="2"></td>
            <!-- 基础佣金系数(%) -->
            <td>
                <input type="text" name="remote_commission_rules" style="width: 108px; margin-left: -28px" onblur="tranceNaN(this,'910082')" maxlength="8" />
            </td>
        </tr>
        <tr class="trTab1" style="background-color: #E5FFE5; height: 35px; display: none">
            <td>
                <select name="commission_type">
                    <option value="1">本季度净增</option>
                    <option value="-1">请选择</option>
                </select>
            </td>
            <td colspan="2">
                <input type="text" name="stock_begin" style="width: 40px;" onblur="tranceNaN(this,'910083')" maxlength="8" />到
                <input type="text" name="stock_end" style="width: 40px;" onblur="tranceNaN(this,'910084')" maxlength="8" />万(含)
            </td>
            <!-- 基础佣金系数(%) -->
            <td>
                <input type="text" name="base_commission" style="width: 108px;" onblur="tranceNaN(this,'910085')" maxlength="8" />
                <a href="#" onclick="addRowYCX(this);">新增</a>
            </td>
        </tr>
        <!-- 月付佣金 -->
        <tr class="trTab2" style="background-color: #666666; color: white;height: 35px; display: none">
            <td width="150px"></td>
            <td></td>
            <td>产品总存量限制</td>
            <td>基础提成系数(%)</td>
        </tr>
        <tr class="trTab2" style="background-color: #E5FFE5; height: 35px; display: none">
            <td width="120px" rowspan="1">佣金系数</td>
            <td>月付佣金</td>
            <td>
                <input type="text" name="stock_begin" style="width: 40px;" onblur="tranceNaN(this,'910086')" maxlength="8" />到
                <input type="text" name="stock_end" style="width: 40px;" onblur="tranceNaN(this,'910087')" maxlength="8" />万(含)
            </td>
            <!-- 基础提成系数(%) -->
            <td>
                <input type="text" name="base_commission" style="width: 108px;" onblur="tranceNaN(this,'910088')" maxlength="8" />
                <a href="#" onclick="addRowYF(this);">新增</a>
            </td>
        </tr>
        <!-- 团队佣金 -->
        <tr class="trTab3" style="background-color: #666666; color: white;height: 35px; display: none">
            <td width="150px"></td>
            <td></td>
            <td>产品总存量限制</td>
            <td>一次性付佣金系数(%)</td>
            <td>月付佣金系数(%)</td>
        </tr>
        <tr class="trTab3" style="background-color: #E5FFE5; height: 35px; display: none">
            <td width="120px" rowspan="1">佣金系数</td>
            <td>
                <select name="commission_type_new">
                    <option value="-1">请选择</option>
                    <option value="0">团队存量</option>
                    <option value="1">团队本月新增</option>
                    <option value="2">团队当月净增</option>
                </select>
            </td>
            <td>
                <input type="text" name="cumulate_begin" style="width: 40px;" onblur="tranceNaN(this,'910089')" maxlength="8" />到
                <input type="text" name="cumulate_end" style="width: 40px;" onblur="tranceNaN(this,'910090')" maxlength="8" />万(含)
            </td>
            <!-- 一次性付佣金系数(%) -->
            <td>
                <input type="text" name="floating_commission_disposable" style="width: 158px;" onblur="tranceNaN(this,'910091')" maxlength="8" />
            </td>
            <!-- 月付佣金系数(%) -->
            <td>
                <input type="text" name="floating_commission_monthly" style="width: 108px;" onblur="tranceNaN(this,'910092')" maxlength="8" />
                <a href="#" onclick="addRowTD(this);">新增</a>
            </td>
        </tr>
        <tr class="hideEnd" style="background-color: #E5FFE5; height: 10px; display: none">
        </tr>
    </table>
    <!--一次性(上单当月给予一次性佣金)(单行添加) -->
    <table id="cloneModelYCX_One" border="1" style="text-align: center; margin-left: 55px; margin-bottom: 5px; margin-top: 3px">       
        <tr class="trTab1" style="background-color: #E5FFE5; height: 35px;">
            <td>
            </td>
            <td>
                <select name="commission_type_one">
                    <option value="1">本月新增</option>
                    <option value="-1">请选择</option>
                </select>
            </td>
            <td>
                <input type="text" name="stock_begin_one" style="width: 40px;" onblur="tranceNaN(this,'930001')" maxlength="8" />到
                <input type="text" name="stock_end_one" style="width: 40px;" onblur="tranceNaN(this,'930002')" maxlength="8" />万(含)
            </td>
            <!-- 基础佣金系数(%) -->
            <td>
                <input type="text" name="base_commission_one" style="width: 108px;" onblur="tranceNaN(this,'930003')" maxlength="8" />
                <a href="#" onclick="deleteRowYCX_One(this);">删除</a>
            </td>
        </tr>
    </table>
    <!--一次性(上单满...个月再按照...)(单行添加) -->
    <table id="cloneModelYCX_Two" border="1" style="text-align: center; margin-left: 55px; margin-bottom: 5px; margin-top: 3px">       
        <tr class="trTab1" style="background-color: #E5FFE5; height: 35px;">
            <td>
            </td>
            <td>
                <input type="text" name="month_count" style="width: 108px;" onblur="tranceNaN(this,'930004')" maxlength="8" />个月
            </td>
            <td>再按照</td>
            <!-- 基础佣金系数(%) -->
            <td>
                <input type="text" name="base_commission_two" style="width: 108px;" onblur="tranceNaN(this,'930005')" maxlength="8" />
                <a href="#" onclick="deleteRowYCX_Two(this);">删除</a>
            </td>
        </tr>
    </table>
    <!--一次性(单行添加) -->
    <table id="cloneModelYCX" border="1" style="text-align: center; margin-left: 55px; margin-bottom: 5px; margin-top: 3px">       
        <tr class="trTab1" style="background-color: #E5FFE5; height: 35px;">
            <td>
                <select name="commission_type">
                    <option value="1">本季度净增</option>
                    <option value="-1">请选择</option>
                </select>
            </td>
            <td colspan="2">
                <input type="text" name="stock_begin" style="width: 40px;" onblur="tranceNaN(this,'910083')" maxlength="8" />到
                <input type="text" name="stock_end" style="width: 40px;" onblur="tranceNaN(this,'910084')"maxlength="8" />万(含)
            </td>
            <td>
                <input type="text" name="base_commission" style="width: 108px;" onblur="tranceNaN(this,'910085')" maxlength="8" />
                <a href="#" onclick="deleteRowYCX(this);">删除</a>
            </td>
        </tr>
    </table>
    <!--月付(单行添加) -->
    <table id="cloneModelYF" border="1" style="text-align: center; margin-left: 55px; margin-bottom: 5px; margin-top: 3px">     
        <tr class="trTab2" style="background-color: #E5FFE5; height: 35px;">
            <td></td>
            <td>
                <input type="text" name="stock_begin" style="width: 40px;" onblur="tranceNaN(this,'910086')" maxlength="8" />到
                <input type="text" name="stock_end" style="width: 40px;" onblur="tranceNaN(this,'910087')"maxlength="8" />万(含)
            </td>
            <td>
                <input type="text" name="base_commission" style="width: 108px;" onblur="tranceNaN(this,'910088')" maxlength="8" />
                <a href="#" onclick="deleteRowYF(this);">删除</a>
            </td>
        </tr>
    </table>
    <!--团队(单行添加) -->
    <table id="cloneModelTD" border="1" style="text-align: center; margin-left: 55px; margin-bottom: 5px; margin-top: 3px">     
        <tr class="trTab3" style="background-color: #E5FFE5; height: 35px;">
            <td>
                <select name="commission_type_new">
                    <option value="-1">请选择</option>
                    <option value="0">团队存量</option>
                    <option value="1">团队本月新增</option>
                    <option value="2">团队当月净增</option>
                </select>
            </td>
            <td>
                <input type="text" name="cumulate_begin" style="width: 40px;" onblur="tranceNaN(this,'910089')" maxlength="8" />到
                <input type="text" name="cumulate_end" style="width: 40px;" onblur="tranceNaN(this,'910090')" maxlength="8" />万(含)
            </td>
            <!-- 一次性付佣金系数(%) -->
            <td>
                <input type="text" name="floating_commission_disposable" style="width: 158px;" onblur="tranceNaN(this,'910091')" maxlength="8" />
            </td>
            <!-- 月付佣金系数(%) -->
            <td>
                <input type="text" name="floating_commission_monthly" style="width: 108px;" onblur="tranceNaN(this,'910092')" maxlength="8" />
                <a href="#" onclick="deleteRowTD(this);">删除</a>
            </td>
        </tr>
    </table>
    <!-- 提交功能按钮区 -->
    <!-- <div class="pop-footer5 clearboth" style="bottom: 1px;">
        <input id="cancelBtnId" class="btn-cancel"
            onmouseover="this.className='btn-cancel-over'"
            onmouseout="this.className='btn-cancel'"
            onmousedown="this.className='btn-cancel-down'" type="button"
            onclick="closeTab();" /> -->
<script type="text/javascript">

var params = {};//分页参数--客户经理
var paramsId = {};//上一页下一页的a标签--客户经理

var paramsjx = {};//分页参数--见习经理
var paramsIdjx = {};//上一页下一页的a标签--见习经理

var paramstd = {};//分页参数--团队经理
var paramsIdtd = {};//上一页下一页的a标签--团队经理

var job_code_kh = "100"//客户经理
var job_code_jx = "102"//见习经理
var job_code_td = "101"//团队经理

var belong_company_list = "";//所属公司下拉列表

$(function() {
    //数据开始初始化并获取
    initbase("all");
    
    //查询归属公司下拉列表值(基础数据)
    $.ajax({ 
        type: "POST", 
        url: global_param.context_name + "/inve/wmsinvecommissiongeneralrulesnewinfo.do",
        async: false,
        dataType: "json",
        data: { 
        	wms_sys_dict_id : 87 
        }, 
        success: function(data){
        	belong_company_list = data.belong_company_list;
        	$('[name=belong_company]').each(function(i, o){
	        	$(o).append('<option value="-1">请选择</option>');
        		for(var j = 0; j < belong_company_list.length; j++){
        			$(o).append(
	        			'<option value="' + belong_company_list[j].value_code + '">' + 
	        			    belong_company_list[j].value_meaning + 
	        			'</option>'
        			);
        		}
            });
        }
    });
    
    
    
});

//初始化基础参数
function initbase(val){
    if(val == job_code_kh || val == "all"){//客户经理
        //分页-***客户经理*****
        params.page = "1";//当前页码
        params.pagesize = "15";//每页显示最大条数
        paramsId.frontPage = 'frontPage';
        paramsId.nextPage = 'nextPage';
        paramsId.page = 'page';
        params.job_code = job_code_kh;
        //*******客户经理*****
        getInfo(params, 'firstPage');//分页-***客户经理*****
    }
    if(val == job_code_jx || val == "all"){//见习经理
        //分页-***见习经理*****
        paramsjx.page = "1";//当前页码
        paramsjx.job_code = job_code_jx;//见习经理
        paramsjx.pagesize = "15";//每页显示最大条数
        paramsIdjx.frontPage = 'frontPagejx';
        paramsIdjx.nextPage = 'nextPagejx';
        paramsIdjx.page = 'pagejx';
        //*******见习经理*****
        getInfo(paramsjx, 'firstPage');//分页-***见习经理*****
    }
    if(val == job_code_td || val == "all"){//团队经理
        //分页-***团队经理*****
        paramstd.page = "1";//当前页码
        paramstd.job_code = job_code_td;//团队经理
        paramstd.pagesize = "15";//每页显示最大条数
        paramsIdtd.frontPage = 'frontPagetd';
        paramsIdtd.nextPage = 'nextPagetd';
        paramsIdtd.page = 'pagetd';
        //*******团队经理*****
        getInfo(paramstd, 'firstPage');//分页-***团队经理*****
    }
}

//新增理财规则--客户
function addNewkh(){
    $("#lcsqxxtrkh").after($("#cloneModelkh tr").clone(true));
    $("#lcsqxxtablekh").find(".noshow").first().find('[name=job_code]').val(job_code_kh);
    $("#lcsqxxtablekh").find(".noshow").first().find('[name=job_code_str]').text("客户经理");
    $("#lcsqxxtablekh").find(".noshow").first().find("td a").last().css("display", "none");
}

//新增理财规则--见习
function addNewjx(){
    $("#lcsqxxtrjx").after($("#cloneModeltd tr").clone(true));
    $("#lcsqxxtablejx").find(".noshow").first().find('[name=job_code]').val(job_code_jx);
    $("#lcsqxxtablejx").find(".noshow").first().find('[name=job_code_str]').text("见习经理");
    $("#lcsqxxtablejx").find(".noshow").first().find("td a").last().css("display", "none");
}

//新增理财规则--团队
function addNewtd(){
    $("#lcsqxxtrtd").after($("#cloneModeltd tr").clone(true));
    $("#lcsqxxtabletd").find(".noshow").first().find('[name=job_code]').val(job_code_td);
    $("#lcsqxxtabletd").find(".noshow").first().find('[name=job_code_str]').text("团队经理");
    $("#lcsqxxtabletd").find(".noshow").first().find("td a").last().css("display", "none");
}

//复制理财规则--客户->客户
function copyNewkh(){
	var startFlag = false;
	var trCopyArray = new Array();
	$("#lcsqxxtablekh tr").each(function(i, o){
		if($(o).hasClass('noshow') && startFlag && i > 1){
            return false;
        }
		if($(o).hasClass('trSelected') || startFlag){
			trCopyArray.push($(o));
			startFlag = true;
		}
	});
	if(trCopyArray.length == 0){
		globalUtil.warnMsg(globalErrorMsg['910095']);
		return false;
	}
	$(trCopyArray.reverse()).each(function(i, o){
        $('#lcsqxxtrkh').after($(o).clone(true));
    });
	//移除选中样式并将复制后的主键id置空
	$('#lcsqxxtablekh .trSelected:first').removeClass('trSelected').
	   find('input[name=wms_inve_commission_general_rules_new_id]').val('');
	//改变样式
	$('#lcsqxxtablekh .noshow:first').addClass('newCopy').siblings().removeClass('newCopy');
	//移除原先状态
	$('#lcsqxxtablekh .noshow:first').find('input[name=state_old_val]').val('');
	//移除创建时间
    $('#lcsqxxtablekh .noshow:first').find('[name=create_datetime]').text('');
    //移除启用时间
    $('#lcsqxxtablekh .noshow:first').find('[name=start_date]').text('');
    //移除禁用时间
    $('#lcsqxxtablekh .noshow:first').find('[name=stop_date]').text('');
    //显示修改按钮(全隐藏后再显示)
    $('#lcsqxxtablekh .noshow:first').find("td:last").find("a").css("display", "none");
    $('#lcsqxxtablekh .noshow:first').find("td:last").find("a:last").css("display", "");
    //鼠标移到详情上将主键id置空
    $('#lcsqxxtablekh .noshow:first').find("a:first").attr('href', "javascript:");
}

//复制理财规则--客户->见习
function copyNewkhToJX(){
	var copyJson = {};//要复制行的数据
	var obj = $("#lcsqxxtablekh .trSelected");
    //主表数据
    var ele = obj.closest("tr");
    copyJson.belonging_company = ele.find('[name=belong_company]').val();//所属公司
    copyJson.ids = ele.find('input[name=wms_inve_pruduct_category_id]').val();//产品id
    copyJson.names = ele.find('span.category_name').text();//产品名称
    
    var ycxCommissionList_one = [];//一次性佣金(上单当月给予一次性佣金)
    var ycxCommissionList_two = [];//一次性佣金(上单满...个月再按照...)
    var ycxCommissionList = [];//一次性佣金
    var yfCommissionList = [];//月付佣金
    
    addNewjx();
    
    obj.nextUntil(".noshow").each(function(i){
        if($(this).find('[name=commission_disposable]').length > 0 && 
                $(this).find('[name=commission_disposable]').val() != null){
        	copyJson.commission_disposable = $(this).find('[name=commission_disposable]').val();//上单当月给予一次性佣金 
        }
        if($(this).find('[name=remote_commission_rules]').length > 0 && 
                $(this).find('[name=remote_commission_rules]').val() != null){
        	copyJson.remote_commission_rules = $(this).find('[name=remote_commission_rules]').val();//匹配异地债权给予佣金
        }
        //获取一次性佣金(上单当月给予一次性佣金)
        if($(this).attr("class") == "trTab1" && $(this).find('[name=stock_begin_one]').length > 0){
            var param_ycx_one = {}; 
            param_ycx_one.stock_begin = $(this).find('[name=stock_begin_one]').val();//一次性佣金[存量限制](单位:万)起始
            param_ycx_one.stock_end = $(this).find('[name=stock_end_one]').val();//一次性佣金[存量限制](单位:万含)截止
            param_ycx_one.base_commission = $(this).find('[name=base_commission_one]').val();//基础提成系数
            param_ycx_one.commission_type = $(this).find('[name=commission_type_one]').val();//佣金计算方式    -1:请选择 1:本季度净增
            ycxCommissionList_one.push(param_ycx_one);
        }
        //获取一次性佣金(上单满...个月再按照...)
        if($(this).attr("class") == "trTab1" && $(this).find('[name=month_count]').length > 0){
            var param_two = {}; 
            param_two.month_count = $(this).find('[name=month_count]').val();//月数
            param_two.base_commission = $(this).find('[name=base_commission_two]').val();//基础提成系数
            ycxCommissionList_two.push(param_two);
        }
        //获取一次性佣金
        if($(this).attr("class") == "trTab1" && $(this).find('[name=stock_begin]').length > 0){
            var param_ycx = {}; 
            param_ycx.stock_begin = $(this).find('[name=stock_begin]').val();//一次性佣金[存量限制](单位:万)起始
            param_ycx.stock_end = $(this).find('[name=stock_end]').val();//一次性佣金[存量限制](单位:万含)截止
            param_ycx.base_commission = $(this).find('[name=base_commission]').val();//基础提成系数
            param_ycx.commission_type = $(this).find('[name=commission_type]').val();//佣金计算方式    -1:请选择 1:本季度净增
            ycxCommissionList.push(param_ycx);
        }
        //获取月付佣金
        if($(this).attr("class") == "trTab2" && $(this).find('[name=stock_begin]').length > 0){
            var param_yf = {}; 
            param_yf.stock_begin = $(this).find('[name=stock_begin]').val();//月付佣金[存量限制](单位:万)起始
            param_yf.stock_end = $(this).find('[name=stock_end]').val();//月付佣金[存量限制](单位:万含)截止
            param_yf.base_commission = $(this).find('[name=base_commission]').val();//基础提成系数
            yfCommissionList.push(param_yf);
        }
    });

    var o = $('#lcsqxxtablejx .noshow').first();//复制后的行
    //一次性佣金添加行(上单当月给予一次性佣金)
    if(ycxCommissionList_one != null){
        for(var h = 0;h < ycxCommissionList_one.length - 1; h++){
            addRowYCX_One($(o).nextUntil(".hideBegin").last().next().next(), "1");
        }
    }
    //一次性佣金添加行(上单满...个月再按照...)
    if(ycxCommissionList_two != null){
        for(var h = 0;h < ycxCommissionList_two.length - 1; h++){
            addRowYCX_Two($(o).nextUntil(".separate").last(), "1");//用匹配异地债权给予佣金作为分隔
        }
    }
    //一次性佣金添加行
    if(ycxCommissionList != null){
        for(var h = 0;h < ycxCommissionList.length - 1; h++){
            addRowYCX(o.nextUntil(".trTab2").last(), "1");
        }
    }
    //月付佣金添加行
    if(yfCommissionList != null){
        for(var h = 0;h < yfCommissionList.length - 1; h++){
            addRowYF(o.nextUntil(".trTab3").last(), "1");
        }
    }
        
    o.find('[name=belong_company]').val(copyJson.belonging_company);//归属公司
    o.find('[name=job_code]').val('102');//职务编号
    o.find('[name=job_code_str]').val('见习经理');//职务名称
    o.find("input[name='wms_inve_pruduct_category_id']").val(copyJson.ids);//ids
    o.find("span.category_name").html(copyJson.names);//names
    isDisabledCegain(copyJson, o);//根据值来处理
    
    var num = 0;
    //一次性佣金赋值(上单当月给予一次性佣金)
    if(ycxCommissionList_one != null && ycxCommissionList_one.length > 0){
        $(o).nextUntil(".noshow").each(function(j, yxc_one){
            if($(yxc_one).attr("class") == "trTab1" && $(yxc_one).find('[name=commission_type_one]').length > 0){
                $(this).find('[name=stock_begin_one]').val(ycxCommissionList_one[num].stock_begin);
                $(this).find('[name=stock_end_one]').val(ycxCommissionList_one[num].stock_end);
                $(this).find('[name=base_commission_one]').val(ycxCommissionList_one[num].base_commission);
                $(this).find('[name=commission_type_one]').val(ycxCommissionList_one[num].commission_type);
                num++;
            }
            isDisabled(ycxCommissionList_one[j], $(this));//根据值来处理
        });
    }
  
    num = 0;
    //一次性佣金赋值(上单满...个月再按照...)
    if(ycxCommissionList_two != null && ycxCommissionList_two.length > 0){
        $(o).nextUntil(".noshow").each(function(j, yxc_two){
            if($(yxc_two).attr("class") == "trTab1" && $(yxc_two).find('[name=month_count]').length > 0){
                $(this).find('[name=month_count]').val(ycxCommissionList_two[num].month_count);
                $(this).find('[name=base_commission_two]').val(ycxCommissionList_two[num].base_commission);
                num++;
            }
            isDisabled(ycxCommissionList_two[j], $(this));//根据值来处理
        });
    }            
    
    num = 0;
    //一次性佣金赋值
    if(ycxCommissionList != null && ycxCommissionList.length > 0){
        o.nextUntil(".noshow").each(function(j, yxc){
            $(yxc).find('[name=remote_commission_rules]').val(copyJson.remote_commission_rules);//匹配异地债权给予佣金
            if($(yxc).attr("class") == "trTab1" && $(yxc).find('[name=stock_begin]').length > 0){
                $(this).find('[name=stock_begin]').val(ycxCommissionList[num].stock_begin);
                $(this).find('[name=stock_end]').val(ycxCommissionList[num].stock_end);
                $(this).find('[name=base_commission]').val(ycxCommissionList[num].base_commission);
                $(this).find('[name=commission_type]').val(ycxCommissionList[num].commission_type);
                num++;
            }
            isDisabled(ycxCommissionList[j], $(this));//根据值来处理
        });
    }
    
    num = 0;
    //月付佣金赋值
    if(yfCommissionList != null && yfCommissionList.length > 0){
        o.nextUntil(".noshow").each(function(j, yf){
            if($(yf).attr("class") == "trTab2" && $(yf).find('[name=stock_begin]').length > 0){
                $(this).find('[name=stock_begin]').val(yfCommissionList[num].stock_begin);
                $(this).find('[name=stock_end]').val(yfCommissionList[num].stock_end);
                $(this).find('[name=base_commission]').val(yfCommissionList[num].base_commission);
                num++;
            }
            isDisabled(yfCommissionList, $(this));//根据值来处理
        });
    }
    
    //改变样式
    $('#lcsqxxtablejx .noshow:first').addClass('newCopy').siblings().removeClass('newCopy');
    //显示修改按钮(全隐藏后再显示)
    $('#lcsqxxtablejx .noshow:first').find("td:last").find("a").css("display", "none");
    $('#lcsqxxtablejx .noshow:first').find("td:last").find("a:last").css("display", "");
}

//复制理财规则--客户->团队
function copyNewkhToTD(){
	var copyJson = {};//要复制行的数据
    var obj = $("#lcsqxxtablekh .trSelected");
    //主表数据
    var ele = obj.closest("tr");
    copyJson.belonging_company = ele.find('[name=belong_company]').val();//所属公司
    copyJson.ids = ele.find('input[name=wms_inve_pruduct_category_id]').val();//产品id
    copyJson.names = ele.find('span.category_name').text();//产品名称
    
    var ycxCommissionList_one = [];//一次性佣金(上单当月给予一次性佣金)
    var ycxCommissionList_two = [];//一次性佣金(上单满...个月再按照...)
    var ycxCommissionList = [];//一次性佣金
    var yfCommissionList = [];//月付佣金
    
    addNewtd();
    
    obj.nextUntil(".noshow").each(function(i){
        if($(this).find('[name=commission_disposable]').length > 0 && 
                $(this).find('[name=commission_disposable]').val() != null){
            copyJson.commission_disposable = $(this).find('[name=commission_disposable]').val();//上单当月给予一次性佣金 
        }
        if($(this).find('[name=remote_commission_rules]').length > 0 && 
                $(this).find('[name=remote_commission_rules]').val() != null){
            copyJson.remote_commission_rules = $(this).find('[name=remote_commission_rules]').val();//匹配异地债权给予佣金
        }
        //获取一次性佣金(上单当月给予一次性佣金)
        if($(this).attr("class") == "trTab1" && $(this).find('[name=stock_begin_one]').length > 0){
            var param_ycx_one = {}; 
            param_ycx_one.stock_begin = $(this).find('[name=stock_begin_one]').val();//一次性佣金[存量限制](单位:万)起始
            param_ycx_one.stock_end = $(this).find('[name=stock_end_one]').val();//一次性佣金[存量限制](单位:万含)截止
            param_ycx_one.base_commission = $(this).find('[name=base_commission_one]').val();//基础提成系数
            param_ycx_one.commission_type = $(this).find('[name=commission_type_one]').val();//佣金计算方式    -1:请选择 1:本季度净增
            ycxCommissionList_one.push(param_ycx_one);
        }
        //获取一次性佣金(上单满...个月再按照...)
        if($(this).attr("class") == "trTab1" && $(this).find('[name=month_count]').length > 0){
            var param_two = {}; 
            param_two.month_count = $(this).find('[name=month_count]').val();//月数
            param_two.base_commission = $(this).find('[name=base_commission_two]').val();//基础提成系数
            ycxCommissionList_two.push(param_two);
        }
        //获取一次性佣金
        if($(this).attr("class") == "trTab1" && $(this).find('[name=stock_begin]').length > 0){
            var param_ycx = {}; 
            param_ycx.stock_begin = $(this).find('[name=stock_begin]').val();//一次性佣金[存量限制](单位:万)起始
            param_ycx.stock_end = $(this).find('[name=stock_end]').val();//一次性佣金[存量限制](单位:万含)截止
            param_ycx.base_commission = $(this).find('[name=base_commission]').val();//基础提成系数
            param_ycx.commission_type = $(this).find('[name=commission_type]').val();//佣金计算方式    -1:请选择 1:本季度净增
            ycxCommissionList.push(param_ycx);
        }
        //获取月付佣金
        if($(this).attr("class") == "trTab2" && $(this).find('[name=stock_begin]').length > 0){
            var param_yf = {}; 
            param_yf.stock_begin = $(this).find('[name=stock_begin]').val();//月付佣金[存量限制](单位:万)起始
            param_yf.stock_end = $(this).find('[name=stock_end]').val();//月付佣金[存量限制](单位:万含)截止
            param_yf.base_commission = $(this).find('[name=base_commission]').val();//基础提成系数
            yfCommissionList.push(param_yf);
        }
    });

    var o = $('#lcsqxxtabletd .noshow').first();//复制后的行
    //一次性佣金添加行(上单当月给予一次性佣金)
    if(ycxCommissionList_one != null){
        for(var h = 0;h < ycxCommissionList_one.length - 1; h++){
            addRowYCX_One($(o).nextUntil(".hideBegin").last().next().next(), "1");
        }
    }
    //一次性佣金添加行(上单满...个月再按照...)
    if(ycxCommissionList_two != null){
        for(var h = 0;h < ycxCommissionList_two.length - 1; h++){
            addRowYCX_Two($(o).nextUntil(".separate").last(), "1");//用匹配异地债权给予佣金作为分隔
        }
    }
    //一次性佣金添加行
    if(ycxCommissionList != null){
        for(var h = 0;h < ycxCommissionList.length - 1; h++){
            addRowYCX(o.nextUntil(".trTab2").last(), "1");
        }
    }
    //月付佣金添加行
    if(yfCommissionList != null){
        for(var h = 0;h < yfCommissionList.length - 1; h++){
            addRowYF(o.nextUntil(".trTab3").last(), "1");
        }
    }
        
    o.find('[name=belong_company]').val(copyJson.belonging_company);//归属公司
    o.find('[name=job_code]').val('101');//职务编号
    o.find('[name=job_code_str]').val('团队经理');//职务名称
    o.find("input[name='wms_inve_pruduct_category_id']").val(copyJson.ids);//ids
    o.find("span.category_name").html(copyJson.names);//names
    isDisabledCegain(copyJson, o);//根据值来处理
    
    var num = 0;
    //一次性佣金赋值(上单当月给予一次性佣金)
    if(ycxCommissionList_one != null && ycxCommissionList_one.length > 0){
        $(o).nextUntil(".noshow").each(function(j, yxc_one){
            if($(yxc_one).attr("class") == "trTab1" && $(yxc_one).find('[name=commission_type_one]').length > 0){
                $(this).find('[name=stock_begin_one]').val(ycxCommissionList_one[num].stock_begin);
                $(this).find('[name=stock_end_one]').val(ycxCommissionList_one[num].stock_end);
                $(this).find('[name=base_commission_one]').val(ycxCommissionList_one[num].base_commission);
                $(this).find('[name=commission_type_one]').val(ycxCommissionList_one[num].commission_type);
                num++;
            }
            isDisabled(ycxCommissionList_one[j], $(this));//根据值来处理
        });
    }
  
    num = 0;
    //一次性佣金赋值(上单满...个月再按照...)
    if(ycxCommissionList_two != null && ycxCommissionList_two.length > 0){
        $(o).nextUntil(".noshow").each(function(j, yxc_two){
            if($(yxc_two).attr("class") == "trTab1" && $(yxc_two).find('[name=month_count]').length > 0){
                $(this).find('[name=month_count]').val(ycxCommissionList_two[num].month_count);
                $(this).find('[name=base_commission_two]').val(ycxCommissionList_two[num].base_commission);
                num++;
            }
            isDisabled(ycxCommissionList_two[j], $(this));//根据值来处理
        });
    }
    
    num = 0;
    //一次性佣金赋值
    if(ycxCommissionList != null && ycxCommissionList.length > 0){
        o.nextUntil(".noshow").each(function(j, yxc){
            $(yxc).find('[name=remote_commission_rules]').val(copyJson.remote_commission_rules);//匹配异地债权给予佣金
            if($(yxc).attr("class") == "trTab1" && $(yxc).find('[name=stock_begin]').length > 0){
                $(this).find('[name=stock_begin]').val(ycxCommissionList[num].stock_begin);
                $(this).find('[name=stock_end]').val(ycxCommissionList[num].stock_end);
                $(this).find('[name=base_commission]').val(ycxCommissionList[num].base_commission);
                $(this).find('[name=commission_type]').val(ycxCommissionList[num].commission_type);
                num++;
            }
            isDisabled(ycxCommissionList[j], $(this));//根据值来处理
        });
    }
    
    num = 0;
    //月付佣金赋值
    if(yfCommissionList != null && yfCommissionList.length > 0){
        o.nextUntil(".noshow").each(function(j, yf){
            if($(yf).attr("class") == "trTab2" && $(yf).find('[name=stock_begin]').length > 0){
                $(this).find('[name=stock_begin]').val(yfCommissionList[num].stock_begin);
                $(this).find('[name=stock_end]').val(yfCommissionList[num].stock_end);
                $(this).find('[name=base_commission]').val(yfCommissionList[num].base_commission);
                num++;
            }
            isDisabled(yfCommissionList, $(this));//根据值来处理
        });
    }
	
    //改变样式
    $('#lcsqxxtabletd .noshow:first').addClass('newCopy').siblings().removeClass('newCopy');
    //显示修改按钮(全隐藏后再显示)
    $('#lcsqxxtabletd .noshow:first').find("td:last").find("a").css("display", "none");
    $('#lcsqxxtabletd .noshow:first').find("td:last").find("a:last").css("display", "");
}

//复制理财规则--见习
function copyNewjx(){
    var startFlag = false;
    var trCopyArray = new Array();
    $("#lcsqxxtablejx tr").each(function(i, o){
    	if($(o).hasClass('noshow') && startFlag && i > 1){
            return false;
        }
        if($(o).hasClass('trSelected') || startFlag){
            trCopyArray.push($(o));
            startFlag = true;
        }
    });
    if(trCopyArray.length == 0){
        globalUtil.warnMsg(globalErrorMsg['910095']);
        return false;
    }
    $(trCopyArray.reverse()).each(function(i, o){
        $('#lcsqxxtrjx').after($(o).clone(true));
    });
    //移除选中样式并将复制后的主键id置空
    $('#lcsqxxtablejx .trSelected:first').removeClass('trSelected').
       find('input[name=wms_inve_commission_general_rules_new_id]').val('');
    //改变样式
    $('#lcsqxxtablejx .noshow:first').addClass('newCopy').siblings().removeClass('newCopy');
    //移除原先状态
    $('#lcsqxxtablejx .noshow:first').find('input[name=state_old_val]').val('');
    //移除创建时间
    $('#lcsqxxtablejx .noshow:first').find('[name=create_datetime]').text('');
    //移除启用时间
    $('#lcsqxxtablejx .noshow:first').find('[name=start_date]').text('');
    //移除禁用时间
    $('#lcsqxxtablejx .noshow:first').find('[name=stop_date]').text('');
    //显示修改按钮(全隐藏后再显示)
    $('#lcsqxxtablejx .noshow:first').find("td:last").find("a").css("display", "none");
    $('#lcsqxxtablejx .noshow:first').find("td:last").find("a:last").css("display", "");
    //鼠标移到详情上将主键id置空
    $('#lcsqxxtablejx .noshow:first').find("a:first").attr('href', "javascript:");
}

//复制理财规则--团队
function copyNewtd(){
    var startFlag = false;
    var trCopyArray = new Array();
    $("#lcsqxxtabletd tr").each(function(i, o){
    	if($(o).hasClass('noshow') && startFlag && i > 1){
            return false;
        }
        if($(o).hasClass('trSelected') || startFlag){
            trCopyArray.push($(o));
            startFlag = true;
        }
    });
    if(trCopyArray.length == 0){
        globalUtil.warnMsg(globalErrorMsg['910095']);
        return false;
    }
    $(trCopyArray.reverse()).each(function(i, o){
        $('#lcsqxxtrtd').after($(o).clone(true));
    });
    //移除选中样式并将复制后的主键id置空
    $('#lcsqxxtabletd .trSelected:first').removeClass('trSelected').
       find('input[name=wms_inve_commission_general_rules_new_id]').val('');
    //改变样式
    $('#lcsqxxtabletd .noshow:first').addClass('newCopy').siblings().removeClass('newCopy');
    //移除原先状态
    $('#lcsqxxtabletd .noshow:first').find('input[name=state_old_val]').val('');
    //移除创建时间
    $('#lcsqxxtabletd .noshow:first').find('[name=create_datetime]').text('');
    //移除启用时间
    $('#lcsqxxtabletd .noshow:first').find('[name=start_date]').text('');
    //移除禁用时间
    $('#lcsqxxtabletd .noshow:first').find('[name=stop_date]').text('');
    //显示修改按钮(全隐藏后再显示)
    $('#lcsqxxtabletd .noshow:first').find("td:last").find("a").css("display", "none");
    $('#lcsqxxtabletd .noshow:first').find("td:last").find("a:last").css("display", "");
    //鼠标移到详情上将主键id置空
    $('#lcsqxxtabletd .noshow:first').find("a:first").attr('href', "javascript:");
}

//显示隐藏详细信息
function showOrhide(obj, status){
	if(status == 'hide'){
		$(obj).closest("tr").nextUntil(".noshow").slideDown('500');
		$(obj).attr('onclick', "showOrhide(this, 'show')");
		
		var allTr = $(obj).closest("tr").nextUntil(".hideEnd");
		var trTabIndex = $(obj).closest("tr").next().next().find('.tabbody1').index();
		if(trTabIndex == 0){//第一组
            allTr.each(function(i, o){
                if($(o).attr('class') == 'trTab2' || $(o).attr('class') == 'trTab3'){
                    $(o).hide();
                }
            });
        }else if(trTabIndex == 1){//第二组
            allTr.each(function(i, o){
                if($(o).attr('class') == 'trTab1' || $(o).attr('class') == 'trTab3'){
                    $(o).hide();
                }
            });
        }else if(trTabIndex == 2){//第三组
            allTr.each(function(i, o){
                if($(o).attr('class') == 'trTab1' || $(o).attr('class') == 'trTab2'){
                    $(o).hide();
                }
            });
        }
	}else if(status == 'show'){
        $(obj).closest("tr").nextUntil(".noshow").slideUp('500');
        $(obj).attr('onclick', "showOrhide(this, 'hide')");
    }
}

//修改所属公司
function changeCompany(obj){
	
}

//新增一次性佣金(上单当月给予一次性佣金)
function addRowYCX_One(obj, val){
	var number = $(obj).closest("tr").find("td").first().attr("rowSpan");
    $(obj).closest("tr").find("td").first().attr("rowSpan", parseInt(number) + 1); 
    $(obj).closest("tr").after($("#cloneModelYCX_One tr").clone(true));
    if(val == "1"){//如果为1隐藏当前添加的元素
        $(obj).closest("tr").next().css("display", "none");
    }else if(val == "0"){
        $(obj).closest("tr").next().css("display", "");
    }
    var val = $(obj).closest("tr").find("[name='commission_type_one']").val();
    $(obj).closest("tr").nextUntil(".noshow").find("[name='commission_type_one']").val(val).attr('disabled', 'disabled');
}

//新增一次性佣金(上单满...个月再按照...)
function addRowYCX_Two(obj, val){
	var number = $(obj).closest("tr").prevUntil('.hideBegin').last().find("td").first().attr("rowSpan");
    $(obj).closest("tr").prevUntil('.hideBegin').last().find("td").first().attr("rowSpan", parseInt(number) + 1); 
    $(obj).closest("tr").after($("#cloneModelYCX_Two tr").clone(true));
    if(val == "1"){//如果为1隐藏当前添加的元素
        $(obj).closest("tr").next().css("display", "none");
    }else if(val == "0"){
        $(obj).closest("tr").next().css("display", "");
    }
}

//新增一次性佣金
function addRowYCX(obj, val){
    var number = $(obj).closest("tr").prevUntil('.hideBegin').last().find("td").first().attr("rowSpan");
    $(obj).closest("tr").prevUntil('.hideBegin').last().find("td").first().attr("rowSpan", parseInt(number) + 1); 
    $(obj).closest("tr").after($("#cloneModelYCX tr").clone(true));
    if(val == "1"){//如果为1隐藏当前添加的元素
        $(obj).closest("tr").next().css("display", "none");
    }else if(val == "0"){
        $(obj).closest("tr").next().css("display", "");
    }
    var val = $(obj).closest("tr").find("[name='commission_type']").val();//当前用户选择的浮动佣金情况
    $(obj).closest("tr").nextUntil(".noshow").find("[name='commission_type']").val(val).attr('disabled', 'disabled');
}

//新增月付佣金
function addRowYF(obj, val){
	var number = $(obj).closest("tr").prevUntil('.trTab1').last().next().find("td").first().attr("rowSpan");
    $(obj).closest("tr").prevUntil('.trTab1').last().next().find("td").first().attr("rowSpan", parseInt(number) + 1); 
    $(obj).closest("tr").after($("#cloneModelYF tr").clone(true));
    if(val == "1"){//如果为1隐藏当前添加的元素
        $(obj).closest("tr").next().css("display", "none");
    }else if(val == "0"){
        $(obj).closest("tr").next().css("display", "");
    }
}

//新增团队佣金
function addRowTD(obj, val){
    var number = $(obj).closest("tr").prevUntil('.trTab2').last().next().find("td").first().attr("rowSpan");
    $(obj).closest("tr").prevUntil('.trTab2').last().next().find("td").first().attr("rowSpan", parseInt(number) + 1);   
    $(obj).closest("tr").after($("#cloneModelTD tr").clone(true));
    if(val == "1"){//如果为1隐藏当前添加的元素
        $(obj).closest("tr").next().css("display", "none");
    }else if(val == "0"){
        $(obj).closest("tr").next().css("display", "");
    }
    var val = $(obj).closest("tr").find("[name='commission_type_new']").val();//当前用户选择的浮动佣金情况
    $(obj).closest("tr").nextUntil(".noshow").find("[name='commission_type_new']").val(val).attr('disabled', 'disabled');
}

//删除一次性佣金(上单当月给予一次性佣金)
function deleteRowYCX_One(obj){
    var number = $(obj).closest("tr").prevUntil(".hideBegin").last().find("td").first().attr("rowSpan");
    $(obj).closest("tr").prevUntil(".hideBegin").last().find("td").first().attr("rowSpan", parseInt(number) - 1);   
    $(obj).closest("tr").remove();
}

//删除一次性佣金(上单满...个月再按照...)
function deleteRowYCX_Two(obj){
    var number = $(obj).closest("tr").prevUntil(".hideBegin").last().find("td").first().attr("rowSpan");
    $(obj).closest("tr").prevUntil(".hideBegin").last().find("td").first().attr("rowSpan", parseInt(number) - 1);   
    $(obj).closest("tr").remove();
}

//删除一次性佣金
function deleteRowYCX(obj){
    var number = $(obj).closest("tr").prevUntil(".hideBegin").last().find("td").first().attr("rowSpan");
    $(obj).closest("tr").prevUntil(".hideBegin").last().find("td").first().attr("rowSpan", parseInt(number) - 1);   
    $(obj).closest("tr").remove();
}

//删除月付佣金
function deleteRowYF(obj){
	var number = $(obj).closest("tr").prevUntil(".trTab1").last().next().find("td").first().attr("rowSpan");
	$(obj).closest("tr").prevUntil(".trTab1").last().next().find("td").first().attr("rowSpan", parseInt(number) - 1);   
    $(obj).closest("tr").remove();
}

//删除团队佣金
function deleteRowTD(obj){
	var number = $(obj).closest("tr").prevUntil(".trTab2").last().next().find("td").first().attr("rowSpan");
    $(obj).closest("tr").prevUntil(".trTab2").last().next().find("td").first().attr("rowSpan", parseInt(number) - 1);   
    $(obj).closest("tr").remove();
}

//产品修改状态
function changeState(obj){
    var state_old_val = $(obj).closest("td").find("[name=state_old_val]").val();
    if(state_old_val == "0" && $(obj).val() == "-1"){//规则状态0为启用 1为禁用
        $(obj).val("0");
        globalUtil.errorMsg(globalErrorMsg['910000']);//已启用产品只能修改为禁用
    }
}

//分页
function getInfo(param, operate){
    //改变页码 operate为操作 是上一页  还是下一页 params为查询参数
    if(wms_page.changePage(param, operate)){
        return; 
    }
    //查询客户经理列表
    list(param);
}

//查询列表
function list(param){
    $.get(globalUtil.getTimestampUrl("/inve/wmsinvecommissiongeneralrulesnewinfo.do"), param, 
        function(json) {
            if (json != null) {
                if (json.Rows.length > 0) {
                    deleteRow(param, json);//删除原来的内容新增行
                    initRow(param, json);//根据单据条数新增行
                    //查询后返回总条数和当前页码
                    if(param.job_code == job_code_kh){//客户经理
                        wms_page.getPage(param, json, paramsId);
                    }else if(param.job_code == job_code_jx){//见习经理
                        wms_page.getPage(param, json, paramsIdjx);
                    }else if(param.job_code == job_code_td){//团队经理
                        wms_page.getPage(param, json, paramsIdtd);
                    }
                    initInfo(param, json);//初始化数据
                }
            }
        }
    ); 
}

//根据后台单据初始化新增行数
function initRow(param, json){
    for(var i = 0;i < json.Rows.length; i++){
        if(param.job_code == job_code_kh){//客户经理
            addNewkh(); 
            $("#lcsqxxtablekh").find(".noshow").first().find("td a").last().css("display", "");
        }else if(param.job_code == job_code_jx){//见习经理
            addNewjx();
            $("#lcsqxxtablejx").find(".noshow").first().find("td a").last().css("display", "");
        }else if(param.job_code == job_code_td){//团队经理
            addNewtd();
            $("#lcsqxxtabletd").find(".noshow").first().find("td a").last().css("display", "");
        }
    }
}

//每次点击分页按钮必须删除增加的行
function deleteRow(param, json){
	for(var i = 0;i < json.Rows.length; i++){
        if(param.job_code == job_code_kh){//客户经理
            $("#lcsqxxtablekh").find(".noshow").each(function(i){//客户经理初始化信息
                $(this).nextUntil(".noshow").each(function(j){
                    $(this).remove();
                });
                $(this).remove();
            }); 
        }else if(param.job_code == job_code_td){//团队经理
            $("#lcsqxxtabletd").find(".noshow").each(function(i){//团队经理初始化信息
                var lengthval = $(this).nextUntil(".tdfloat").last().nextUntil(".noshow").length;
                $(this).nextUntil(".tdfloat").last().nextUntil(".noshow").each(function(m){//浮动工资
                    if(m < lengthval - 1){
                        $(this).remove();
                    }
                });
            }); 
            $("#lcsqxxtabletd").find(".noshow").each(function(i){//团队经理初始化信息
                $(this).nextUntil(".tdfloat").each(function(j){//tdfloat
                    $(this).remove();
                });
                $(this).remove();
            }); 
        }else if(param.job_code == job_code_jx){//见习经理
            $("#lcsqxxtablejx").find(".noshow").each(function(i){//见习经理初始化信息
                var lengthval = $(this).nextUntil(".tdfloat").last().nextUntil(".noshow").length;
                $(this).nextUntil(".tdfloat").last().nextUntil(".noshow").each(function(m){//浮动工资
                    if(m < lengthval - 1){
                        $(this).remove();
                    }
                });
            }); 
            $("#lcsqxxtablejx").find(".noshow").each(function(i){//见习经理初始化信息
                $(this).nextUntil(".tdfloat").each(function(j){//tdfloat
                    $(this).remove();
                });
                $(this).remove();
            }); 
        }
    }
}

//初始化数据
function initInfo(param, json){
    if(param.job_code == job_code_kh){//客户经理
        $("#lcsqxxtablekh").find(".noshow").each(function(i, o){//客户经理初始化信息
        	//一次性佣金添加行(上单当月给予一次性佣金)
            if(json.Rows[i].disposable_one != null){
                for(var h = 0;h < json.Rows[i].disposable_one.length - 1; h++){
                    addRowYCX_One($(o).nextUntil(".hideBegin").last().next().next(), "1");
                }
            }
            //一次性佣金添加行(上单满...个月再按照...)
            if(json.Rows[i].disposable_two != null){
                for(var h = 0;h < json.Rows[i].disposable_two.length - 1; h++){
                    addRowYCX_Two($(o).nextUntil(".separate").last(), "1");//用匹配异地债权给予佣金作为分隔
                }
            }
        	//一次性佣金添加行
            if(json.Rows[i].disposable != null){
                for(var h = 0;h < json.Rows[i].disposable.length - 1; h++){
                    addRowYCX($(o).nextUntil(".trTab2").last(), "1");
                }
            }
            //月付佣金添加行
            if(json.Rows[i].parammonthly != null){
                for(var h = 0;h < json.Rows[i].parammonthly.length - 1; h++){
                    addRowYF($(o).nextUntil(".hideEnd").last(), "1");
                }
            }
            
            //详情鼠标移上去显示主表id
            $(this).find('a:first').attr('href', 'javascript:' + json.Rows[i].wms_inve_commission_general_rules_new_id);
            $(this).find('[name=wms_inve_commission_general_rules_new_id]').val(json.Rows[i].wms_inve_commission_general_rules_new_id);//主表主键   
            $(this).find('[name=belong_company]').val(json.Rows[i].belonging_company);//归属公司
            $(this).find('[name=job_code]').val(json.Rows[i].job_code);//职务编号
            $(this).find('[name=job_code_str]').val(json.Rows[i].job_code_str);//职务名称
            $(this).find('[name=employee_state]').val(json.Rows[i].employee_state);//员工状态
            $(this).find('[name=page_rule_state]').val(json.Rows[i].page_rule_state);//规则状态
            $(this).find('[name=state_old_val]').val(json.Rows[i].page_rule_state);//规则状态--保存初始值
            $(this).find('[name=create_datetime]').text(json.Rows[i].create_datetime_str);//创建时间
            $(this).find('[name=start_date]').text(json.Rows[i].start_date_str);//启用时间
            $(this).find('[name=stop_date]').text(json.Rows[i].stop_date_str);//禁用时间
            $(this).find("input[name='wms_inve_pruduct_category_id']").val(json.Rows[i].ids);//ids
            $(this).find("span.category_name").html(json.Rows[i].names);//names          
            isDisabledCegain(json.Rows[i], $(this));//根据值来处理
            var num = 0;
            
            //一次性佣金赋值(上单当月给予一次性佣金)
            if(json.Rows[i].disposable_one != null && json.Rows[i].disposable_one.length > 0){
                $(o).nextUntil(".noshow").each(function(j, yxc_one){
                    if($(yxc_one).attr("class") == "trTab1" && $(yxc_one).find('[name=commission_type_one]').length > 0){
                        $(this).find('[name=stock_begin_one]').val(json.Rows[i].disposable_one[num].stock_begin);
                        $(this).find('[name=stock_end_one]').val(json.Rows[i].disposable_one[num].stock_end);
                        $(this).find('[name=base_commission_one]').val(json.Rows[i].disposable_one[num].base_commission);
                        $(this).find('[name=commission_type_one]').val(json.Rows[i].disposable_one[num].commission_type);
                        num++;
                    }
                    isDisabled(json.Rows[i], $(this));//根据值来处理
                });
            }
          
            num = 0;
            //一次性佣金赋值(上单满...个月再按照...)
            if(json.Rows[i].disposable_two != null && json.Rows[i].disposable_two.length > 0){
                $(o).nextUntil(".noshow").each(function(j, yxc_two){
                    if($(yxc_two).attr("class") == "trTab1" && $(yxc_two).find('[name=month_count]').length > 0){
                        $(this).find('[name=month_count]').val(json.Rows[i].disposable_two[num].month_count);
                        $(this).find('[name=base_commission_two]').val(json.Rows[i].disposable_two[num].base_commission);
                        num++;
                    }
                    isDisabled(json.Rows[i], $(this));//根据值来处理
                });
            }            
            
            num = 0;
            //一次性佣金赋值
            if(json.Rows[i].disposable != null && json.Rows[i].disposable.length > 0){
	            $(o).nextUntil(".noshow").each(function(j, yxc){
                    $(yxc).find('[name=remote_commission_rules]').val(json.Rows[i].remote_commission_rules);//匹配异地债权给予佣金
                    if($(yxc).attr("class") == "trTab1" && $(yxc).find('[name=stock_begin]').length > 0){
                   		$(this).find('[name=stock_begin]').val(json.Rows[i].disposable[num].stock_begin);
                   		$(this).find('[name=stock_end]').val(json.Rows[i].disposable[num].stock_end);
                   		$(this).find('[name=base_commission]').val(json.Rows[i].disposable[num].base_commission);
                   		$(this).find('[name=commission_type]').val(json.Rows[i].disposable[num].commission_type);
                        num++;
                    }
	                isDisabled(json.Rows[i], $(this));//根据值来处理
	            });
            }
            
            num = 0;
            //月付佣金赋值
            if(json.Rows[i].parammonthly != null && json.Rows[i].parammonthly.length > 0){
                $(o).nextUntil(".noshow").each(function(j, yf){
                    if($(yf).attr("class") == "trTab2" && $(yf).find('[name=stock_begin]').length > 0){
                        $(this).find('[name=stock_begin]').val(json.Rows[i].parammonthly[num].stock_begin);
                        $(this).find('[name=stock_end]').val(json.Rows[i].parammonthly[num].stock_end);
                        $(this).find('[name=base_commission]').val(json.Rows[i].parammonthly[num].base_commission);
                        num++;
                    }
                    isDisabled(json.Rows[i], $(this));//根据值来处理
                });
            }
            
        }); 
    }else if(param.job_code == job_code_jx){//见习经理
        $("#lcsqxxtablejx").find(".noshow").each(function(i, o){//初始化信息
        	//一次性佣金添加行(上单当月给予一次性佣金)
            if(json.Rows[i].disposable_one != null){
                for(var h = 0;h < json.Rows[i].disposable_one.length - 1; h++){
                    addRowYCX_One($(o).nextUntil(".hideBegin").last().next().next(), "1");
                }
            }
            //一次性佣金添加行(上单满...个月再按照...)
            if(json.Rows[i].disposable_two != null){
                for(var h = 0;h < json.Rows[i].disposable_two.length - 1; h++){
                    addRowYCX_Two($(o).nextUntil(".separate").last(), "1");//用匹配异地债权给予佣金作为分隔
                }
            }
        	//一次性佣金添加行
            if(json.Rows[i].disposable != null){
                for(var h = 0;h < json.Rows[i].disposable.length - 1; h++){
                    addRowYCX($(o).nextUntil(".trTab2").last(), "1");
                }
            }
            //月付佣金添加行
            if(json.Rows[i].parammonthly != null){
                for(var h = 0;h < json.Rows[i].parammonthly.length - 1; h++){
                    addRowYF($(o).nextUntil(".trTab3").last(), "1");
                }
            }
            //团队(浮动)佣金添加行
            if(json.Rows[i].commissionfloating != null){
                for(var h = 0;h < json.Rows[i].commissionfloating.length - 1; h++){
                    addRowTD($(o).nextUntil(".hideEnd").last(), "1");
                }
            }
            
            //详情鼠标移上去显示主表id
            $(this).find('a:first').attr('href', 'javascript:' + json.Rows[i].wms_inve_commission_general_rules_new_id);
            $(this).find('[name=wms_inve_commission_general_rules_new_id]').val(json.Rows[i].wms_inve_commission_general_rules_new_id);//主表主键   
            $(this).find('[name=belong_company]').val(json.Rows[i].belonging_company);//归属公司
            $(this).find('[name=job_code]').val(json.Rows[i].job_code);//职务编号
            $(this).find('[name=job_code_str]').val(json.Rows[i].job_code_str);//职务名称
            $(this).find('[name=employee_state]').val(json.Rows[i].employee_state);//员工状态
            $(this).find('[name=page_rule_state]').val(json.Rows[i].page_rule_state);//规则状态
            $(this).find('[name=state_old_val]').val(json.Rows[i].page_rule_state);//规则状态--保存初始值
            $(this).find('[name=create_datetime]').text(json.Rows[i].create_datetime_str);//创建时间
            $(this).find('[name=start_date]').text(json.Rows[i].start_date_str);//启用时间
            $(this).find('[name=stop_date]').text(json.Rows[i].stop_date_str);//禁用时间
            $(this).find("input[name='wms_inve_pruduct_category_id']").val(json.Rows[i].ids);//ids
            $(this).find("span.category_name").html(json.Rows[i].names);//names
            isDisabledCegain(json.Rows[i], $(this));//根据值来处理
            var num = 0;
            
            //一次性佣金赋值(上单当月给予一次性佣金)
            if(json.Rows[i].disposable_one != null && json.Rows[i].disposable_one.length > 0){
                $(o).nextUntil(".noshow").each(function(j, yxc_one){
                    if($(yxc_one).attr("class") == "trTab1" && $(yxc_one).find('[name=commission_type_one]').length > 0){
                        $(this).find('[name=stock_begin_one]').val(json.Rows[i].disposable_one[num].stock_begin);
                        $(this).find('[name=stock_end_one]').val(json.Rows[i].disposable_one[num].stock_end);
                        $(this).find('[name=base_commission_one]').val(json.Rows[i].disposable_one[num].base_commission);
                        $(this).find('[name=commission_type_one]').val(json.Rows[i].disposable_one[num].commission_type);
                        num++;
                    }
                    isDisabled(json.Rows[i], $(this));//根据值来处理
                });
            }
          
            num = 0;
            //一次性佣金赋值(上单满...个月再按照...)
            if(json.Rows[i].disposable_two != null && json.Rows[i].disposable_two.length > 0){
                $(o).nextUntil(".noshow").each(function(j, yxc_two){
                    if($(yxc_two).attr("class") == "trTab1" && $(yxc_two).find('[name=month_count]').length > 0){
                        $(this).find('[name=month_count]').val(json.Rows[i].disposable_two[num].month_count);
                        $(this).find('[name=base_commission_two]').val(json.Rows[i].disposable_two[num].base_commission);
                        num++;
                    }
                    isDisabled(json.Rows[i], $(this));//根据值来处理
                });
            }
            
            num = 0;
            //一次性佣金赋值
            if(json.Rows[i].disposable != null && json.Rows[i].disposable.length > 0){
                $(o).nextUntil(".noshow").each(function(j, yxc){
                   	$(yxc).find('[name=commission_disposable]').val(json.Rows[i].commission_disposable);//上单当月给予一次性佣金
                    $(yxc).find('[name=remote_commission_rules]').val(json.Rows[i].remote_commission_rules);//匹配异地债权给予佣金
                    if($(yxc).attr("class") == "trTab1" && $(yxc).find('[name=stock_begin]').length > 0){
                        $(this).find('[name=stock_begin]').val(json.Rows[i].disposable[num].stock_begin);
                        $(this).find('[name=stock_end]').val(json.Rows[i].disposable[num].stock_end);
                        $(this).find('[name=base_commission]').val(json.Rows[i].disposable[num].base_commission);
                        $(this).find('[name=commission_type]').val(json.Rows[i].disposable[num].commission_type);
                        num++;
                    }
                    isDisabled(json.Rows[i], $(this));//根据值来处理
                });
            }
            
            num = 0;
            //月付佣金赋值
            if(json.Rows[i].parammonthly != null && json.Rows[i].parammonthly.length > 0){
                $(o).nextUntil(".noshow").each(function(j, yf){
                    if($(yf).attr("class") == "trTab2" && $(yf).find('[name=stock_begin]').length > 0){
                        $(this).find('[name=stock_begin]').val(json.Rows[i].parammonthly[num].stock_begin);
                        $(this).find('[name=stock_end]').val(json.Rows[i].parammonthly[num].stock_end);
                        $(this).find('[name=base_commission]').val(json.Rows[i].parammonthly[num].base_commission);
                        num++;
                    }
                    isDisabled(json.Rows[i], $(this));//根据值来处理
                });
            }
            
            num = 0;
            //团队佣金赋值
            if(json.Rows[i].commissionfloating != null && json.Rows[i].commissionfloating.length > 0){
                $(o).nextUntil(".noshow").each(function(j, td){
                    if($(td).attr("class") == "trTab3" && $(td).find('[name=commission_type_new]').length > 0){
                        $(this).find('[name=commission_type_new]').val(json.Rows[i].commissionfloating[num].commission_type);
                        $(this).find('[name=cumulate_begin]').val(json.Rows[i].commissionfloating[num].cumulate_begin);
                        $(this).find('[name=cumulate_end]').val(json.Rows[i].commissionfloating[num].cumulate_end);
                        $(this).find('[name=floating_commission_disposable]').val(json.Rows[i].commissionfloating[num].floating_commission_disposable);
                        $(this).find('[name=floating_commission_monthly]').val(json.Rows[i].commissionfloating[num].floating_commission_monthly);
                        num++;
                    }
                    isDisabled(json.Rows[i], $(this));//根据值来处理
                });
            }
        }); 
    }else if(param.job_code == job_code_td){//团队经理
        $("#lcsqxxtabletd").find(".noshow").each(function(i, o){//初始化信息
        	//一次性佣金添加行(上单当月给予一次性佣金)
            if(json.Rows[i].disposable_one != null){
                for(var h = 0;h < json.Rows[i].disposable_one.length - 1; h++){
                    addRowYCX_One($(o).nextUntil(".hideBegin").last().next().next(), "1");
                }
            }
            //一次性佣金添加行(上单满...个月再按照...)
            if(json.Rows[i].disposable_two != null){
                for(var h = 0;h < json.Rows[i].disposable_two.length - 1; h++){
                    addRowYCX_Two($(o).nextUntil(".separate").last(), "1");//用匹配异地债权给予佣金作为分隔
                }
            }
        	//一次性佣金添加行
            if(json.Rows[i].disposable != null){
                for(var h = 0;h < json.Rows[i].disposable.length - 1; h++){
                    addRowYCX($(o).nextUntil(".trTab2").last(), "1");
                }
            }
            //月付佣金添加行
            if(json.Rows[i].parammonthly != null){
                for(var h = 0;h < json.Rows[i].parammonthly.length - 1; h++){
                    addRowYF($(o).nextUntil(".trTab3").last(), "1");
                }
            }
            //团队(浮动)佣金添加行
            if(json.Rows[i].commissionfloating != null){
                for(var h = 0;h < json.Rows[i].commissionfloating.length - 1; h++){
                    addRowTD($(o).nextUntil(".hideEnd").last(), "1");
                }
            }
            
            //详情鼠标移上去显示主表id
            $(this).find('a:first').attr('href', 'javascript:' + json.Rows[i].wms_inve_commission_general_rules_new_id);
            $(this).find('[name=wms_inve_commission_general_rules_new_id]').val(json.Rows[i].wms_inve_commission_general_rules_new_id);//主表主键   
            $(this).find('[name=belong_company]').val(json.Rows[i].belonging_company);//归属公司
            $(this).find('[name=job_code]').val(json.Rows[i].job_code);//职务编号
            $(this).find('[name=job_code_str]').val(json.Rows[i].job_code_str);//职务名称
            $(this).find('[name=employee_state]').val(json.Rows[i].employee_state);//员工状态
            $(this).find('[name=page_rule_state]').val(json.Rows[i].page_rule_state);//规则状态
            $(this).find('[name=state_old_val]').val(json.Rows[i].page_rule_state);//规则状态--保存初始值
            $(this).find('[name=create_datetime]').text(json.Rows[i].create_datetime_str);//创建时间
            $(this).find('[name=start_date]').text(json.Rows[i].start_date_str);//启用时间
            $(this).find('[name=stop_date]').text(json.Rows[i].stop_date_str);//禁用时间
            $(this).find("input[name='wms_inve_pruduct_category_id']").val(json.Rows[i].ids);//ids
            $(this).find("span.category_name").html(json.Rows[i].names);//names
            isDisabledCegain(json.Rows[i], $(this));//根据值来处理
            var num = 0;
            
            //一次性佣金赋值(上单当月给予一次性佣金)
            if(json.Rows[i].disposable_one != null && json.Rows[i].disposable_one.length > 0){
                $(o).nextUntil(".noshow").each(function(j, yxc_one){
                    if($(yxc_one).attr("class") == "trTab1" && $(yxc_one).find('[name=commission_type_one]').length > 0){
                        $(this).find('[name=stock_begin_one]').val(json.Rows[i].disposable_one[num].stock_begin);
                        $(this).find('[name=stock_end_one]').val(json.Rows[i].disposable_one[num].stock_end);
                        $(this).find('[name=base_commission_one]').val(json.Rows[i].disposable_one[num].base_commission);
                        $(this).find('[name=commission_type_one]').val(json.Rows[i].disposable_one[num].commission_type);
                        num++;
                    }
                    isDisabled(json.Rows[i], $(this));//根据值来处理
                });
            }
          
            num = 0;
            //一次性佣金赋值(上单满...个月再按照...)
            if(json.Rows[i].disposable_two != null && json.Rows[i].disposable_two.length > 0){
                $(o).nextUntil(".noshow").each(function(j, yxc_two){
                    if($(yxc_two).attr("class") == "trTab1" && $(yxc_two).find('[name=month_count]').length > 0){
                        $(this).find('[name=month_count]').val(json.Rows[i].disposable_two[num].month_count);
                        $(this).find('[name=base_commission_two]').val(json.Rows[i].disposable_two[num].base_commission);
                        num++;
                    }
                    isDisabled(json.Rows[i], $(this));//根据值来处理
                });
            }
            
            num = 0;
            //一次性佣金赋值
            if(json.Rows[i].disposable != null && json.Rows[i].disposable.length > 0){
                $(o).nextUntil(".noshow").each(function(j, yxc){
                   	$(yxc).find('[name=commission_disposable]').val(json.Rows[i].commission_disposable);//上单当月给予一次性佣金
                    $(yxc).find('[name=remote_commission_rules]').val(json.Rows[i].remote_commission_rules);//匹配异地债权给予佣金
                    if($(yxc).attr("class") == "trTab1" && $(yxc).find('[name=stock_begin]').length > 0){
                        $(this).find('[name=stock_begin]').val(json.Rows[i].disposable[num].stock_begin);
                        $(this).find('[name=stock_end]').val(json.Rows[i].disposable[num].stock_end);
                        $(this).find('[name=base_commission]').val(json.Rows[i].disposable[num].base_commission);
                        $(this).find('[name=commission_type]').val(json.Rows[i].disposable[num].commission_type);
                        num++;
                    }
                    isDisabled(json.Rows[i], $(this));//根据值来处理
                });
            }
            
            num = 0;
            //月付佣金赋值
            if(json.Rows[i].parammonthly != null && json.Rows[i].parammonthly.length > 0){
                $(o).nextUntil(".noshow").each(function(j, yf){
                    if($(yf).attr("class") == "trTab2" && $(yf).find('[name=stock_begin]').length > 0){
                        $(this).find('[name=stock_begin]').val(json.Rows[i].parammonthly[num].stock_begin);
                        $(this).find('[name=stock_end]').val(json.Rows[i].parammonthly[num].stock_end);
                        $(this).find('[name=base_commission]').val(json.Rows[i].parammonthly[num].base_commission);
                        num++;
                    }
                    isDisabled(json.Rows[i], $(this));//根据值来处理
                });
            }
            
            num = 0;
            //团队佣金赋值
            if(json.Rows[i].commissionfloating != null && json.Rows[i].commissionfloating.length > 0){
                $(o).nextUntil(".noshow").each(function(j, td){
                    if($(td).attr("class") == "trTab3" && $(td).find('[name=commission_type_new]').length > 0){
                        $(this).find('[name=commission_type_new]').val(json.Rows[i].commissionfloating[num].commission_type);
                        $(this).find('[name=cumulate_begin]').val(json.Rows[i].commissionfloating[num].cumulate_begin);
                        $(this).find('[name=cumulate_end]').val(json.Rows[i].commissionfloating[num].cumulate_end);
                        $(this).find('[name=floating_commission_disposable]').val(json.Rows[i].commissionfloating[num].floating_commission_disposable);
                        $(this).find('[name=floating_commission_monthly]').val(json.Rows[i].commissionfloating[num].floating_commission_monthly);
                        num++;
                    }
                    isDisabled(json.Rows[i], $(this));//根据值来处理
                });
            }
        }); 
    }       
}

//根据数据状态设置显示并处理是否可以修改
function isDisabledCegain(jsonVal, obj){
	obj.find('[name=belong_company]').attr("disabled", "disabled");//所属公司
    obj.find('[name=employee_state]').attr("disabled", "disabled");//员工状态
    obj.find('[name=page_rule_state]').attr("disabled", "disabled");//规则状态
    obj.find('.selectObj').css("display", "none")//选择按钮     
    if(jsonVal.page_rule_state == "1"){
        obj.find("td").last().find("a").css("display", "none");
    }else if(jsonVal.page_rule_state == "0"){
        obj.find("td").last().find("a").first().css("display", "none");
    }else if(jsonVal.page_rule_state == "-1"){
        obj.find("td").last().find("a").first().css("display", "none");
    }
}
//根据数据状态设置显示并处理是否可以修改
function isDisabled(jsonVal, obj){
	obj.find('[name=commission_type_one]').attr("disabled", "disabled");
	obj.find('[name=stock_begin_one]').attr("disabled", "disabled");
	obj.find('[name=stock_end_one]').attr("disabled", "disabled");
	obj.find('[name=base_commission_one]').attr("disabled", "disabled");
	
	obj.find('[name=month_count]').attr("disabled", "disabled");
	obj.find('[name=base_commission_two]').attr("disabled", "disabled");
	
    obj.find('[name=stock_begin]').attr("disabled", "disabled");//月付佣金[存量限制](单位:万)起始
    obj.find('[name=stock_end]').attr("disabled", "disabled");//月付佣金[存量限制](单位:含)截止
    obj.find('[name=base_commission]').attr("disabled", "disabled");//基础提成系数

    obj.find('[name=remote_commission_rules]').attr("disabled", "disabled");//匹配异地债权给予佣金
    
    obj.find('[name=cumulate_begin]').attr("disabled", "disabled");//累计开始金额(浮动)
    obj.find('[name=cumulate_end]').attr("disabled", "disabled");//累计结算金额(浮动)
    obj.find('[name=floating_commission_disposable]').attr("disabled", "disabled");//一次性支付佣金系数(浮动)
    obj.find('[name=floating_commission_monthly]').attr("disabled", "disabled");//月付(浮动)
    
    obj.find('[name=commission_type]').attr("disabled", "disabled");//佣金计算方式(客户)
    obj.find('[name=commission_type_new]').attr("disabled", "disabled");//佣金计算方式(见习、团队)
    
    obj.find("td").last().find("a").css("display", "none");
}

//根据数据状态设置显示并处理是否可以修改
function isDisabledEnd(jsonVal, obj){
    obj.find('[name=commission_type]').attr("disabled", "disabled");//佣金计算方式
    obj.find('[name=cumulate_begin]').attr("disabled", "disabled");//累计开始金额
    obj.find('[name=cumulate_end]').attr("disabled", "disabled");//累计结算金额
    obj.find('[name=floating_commission_disposable]').attr("disabled", "disabled");//浮动佣金系数一次性支付佣金系数
    obj.find('[name=floating_commission_monthly]').attr("disabled", "disabled");//浮动佣金系数月付佣金系数
    obj.find("td").last().find("a").css("display", "none");
}

//非数字的值置空
function tranceNaN(obj, msg) {
    var val = $(obj).val();
    if(isNaN(val)){
        $(obj).val("");
        globalUtil.warnMsg(globalErrorMsg[msg], function(){
            $(obj).focus(); 
        });
    }
}

//判断是否为正整数
function isPositiveInteger(obj, msg) {
	var val = $(obj).val();
    if(val != '' && (isNaN(val) || !/^[1-9]*[1-9][0-9]*$/.test(val))){
        $(obj).val("");
        globalUtil.warnMsg(globalErrorMsg[msg], function(){
            $(obj).focus(); 
        });
    }
}

//修改按钮
function update(obj){//规则状态 0启用 1禁用
    $(obj).css("display", "none");//修改按钮
    $(obj).prev().css("display", "");//保存按钮
    var page_rule_state = $(obj).closest("tr").find("[name=page_rule_state]").val();//获取当前规则状态
    if(page_rule_state == "-1"){
        $(obj).closest("tr").find(".selectObj").css("display", "");
        $(obj).closest("tr").find("input,select").removeAttr("disabled");//移除不可编辑
        $(obj).closest("tr").nextUntil(".noshow").find("input,select").removeAttr("disabled");//移除不可编辑
        $(obj).closest("tr").nextUntil(".noshow").find("a").css("display", "");
    }else if(page_rule_state == "0"){
        $(obj).closest("tr").find("[name=page_rule_state]").removeAttr("disabled");//移除不可编辑
    }
}

//保存
function save(obj){
    var param = {};
    //主表数据
    var ele = $(obj).closest("tr");
    param.belonging_company = ele.find('[name=belong_company]').val();//所属公司
    param.wms_inve_commission_general_rules_new_id = ele.find('[name=wms_inve_commission_general_rules_new_id]').val();//客户经理
    param.job_code = ele.find('[name=job_code]').val();//客户经理
    param.employee_state = ele.find('[name=employee_state]').val();//员工状态
    param.page_rule_sate = ele.find('[name=page_rule_state]').val();//规则状态
    
    var ycxCommissionList_one = [];//一次性佣金(上单当月给予一次性佣金)
    var ycxCommissionList_two = [];//一次性佣金(上单满...个月再按照...)
    var ycxCommissionList = [];//一次性佣金
    var yfCommissionList = [];//月付佣金
    var fdCommissionList = [];//浮动佣金
    
    $(obj).closest("tr").nextUntil(".noshow").each(function(i){
        if($(this).find('[name=remote_commission_rules]').length > 0 && 
        		$(this).find('[name=remote_commission_rules]').val() != null){
            param.remote_commission_rules = $(this).find('[name=remote_commission_rules]').val();//匹配异地债权给予佣金
        }
        //获取一次性佣金(上单当月给予一次性佣金)
        if($(this).attr("class") == "trTab1" && $(this).find('[name=stock_begin_one]').length > 0){
            var param_ycx_one = {}; 
            param_ycx_one.stock_begin = $(this).find('[name=stock_begin_one]').val();//一次性佣金[存量限制](单位:万)起始
            param_ycx_one.stock_end = $(this).find('[name=stock_end_one]').val();//一次性佣金[存量限制](单位:万含)截止
            param_ycx_one.base_commission = $(this).find('[name=base_commission_one]').val();//基础提成系数
            param_ycx_one.commission_type = $(this).find('[name=commission_type_one]').val();//佣金计算方式    -1:请选择 1:本季度净增
            ycxCommissionList_one.push(param_ycx_one);
        }
        //获取一次性佣金(上单满...个月再按照...)
        if($(this).attr("class") == "trTab1" && $(this).find('[name=month_count]').length > 0){
            var param_two = {}; 
            param_two.month_count = $(this).find('[name=month_count]').val();//月数
            param_two.base_commission = $(this).find('[name=base_commission_two]').val();//基础提成系数
            ycxCommissionList_two.push(param_two);
        }
        //获取一次性佣金
        if($(this).attr("class") == "trTab1" && $(this).find('[name=stock_begin]').length > 0){
            var param_ycx = {}; 
            param_ycx.stock_begin = $(this).find('[name=stock_begin]').val();//一次性佣金[存量限制](单位:万)起始
            param_ycx.stock_end = $(this).find('[name=stock_end]').val();//一次性佣金[存量限制](单位:万含)截止
            param_ycx.base_commission = $(this).find('[name=base_commission]').val();//基础提成系数
            param_ycx.commission_type = $(this).find('[name=commission_type]').val();//佣金计算方式    -1:请选择 1:本季度净增
            ycxCommissionList.push(param_ycx);
        }
        //获取月付佣金
        if($(this).attr("class") == "trTab2" && $(this).find('[name=stock_begin]').length > 0){
            var param_yf = {}; 
            param_yf.stock_begin = $(this).find('[name=stock_begin]').val();//月付佣金[存量限制](单位:万)起始
            param_yf.stock_end = $(this).find('[name=stock_end]').val();//月付佣金[存量限制](单位:万含)截止
            param_yf.base_commission = $(this).find('[name=base_commission]').val();//基础提成系数
            yfCommissionList.push(param_yf);
        }
        //获取浮动佣金
        if($(this).attr("class") == "trTab3" && $(this).find('[name=cumulate_begin]').length > 0){
            var param_fd = {};  
            param_fd.commission_type = $(this).find('[name=commission_type_new]').val();//佣金计算方式
            param_fd.cumulate_begin = $(this).find('[name=cumulate_begin]').val();//累计开始金额
            param_fd.cumulate_end  = $(this).find('[name=cumulate_end]').val();//累计结算金额
            param_fd.floating_commission_disposable = $(this).find('[name=floating_commission_disposable]').val();//浮动佣金系数一次性支付佣金系数
            param_fd.floating_commission_monthly = $(this).find('[name=floating_commission_monthly]').val();//浮动佣金系数月付佣金系数
            fdCommissionList.push(param_fd);
        }
    });

    param.disposable_one = JSON.stringify(ycxCommissionList_one);//一次性佣金(上单当月给予一次性佣金)
    param.disposable_two = JSON.stringify(ycxCommissionList_two);//一次性佣金(上单满...个月再按照...)
    param.disposable = JSON.stringify(ycxCommissionList);//一次性佣金
    param.parammonthly = JSON.stringify(yfCommissionList);//月付佣金
    param.commission_floating = JSON.stringify(fdCommissionList);//月付佣金
    
    param.category_ids = ele.find('[name=wms_inve_pruduct_category_id]').val();//产品id list
    param.category_names = ele.find('.category_name').text();//产品名称list
    
    //必填校验(外层列表)
    if(validRequired(param, obj)){
        return;
    }
    //必填校验(上单当月给予一次性佣金)
    if(validRequiredYCX_One(ycxCommissionList_one, obj)){
    	return;
    }
    //必填校验(上单满...个月再按照...)
    if(validRequiredYCX_Two(ycxCommissionList_two, obj)){
    	return;
    }
    /* if(param.remote_commission_rules == null || param.remote_commission_rules == ""){//匹配异地债权给予佣金
        globalUtil.warnMsg(globalErrorMsg['910063']);
        return;
    } */
    //必填校验(一次性佣金)
    /* if(validRequiredYCX(ycxCommissionList, obj)){
        return;
    } */
    //必填校验(月付佣金)
    if(validRequired_YF(yfCommissionList, obj)){
        return;
    }
    //见习/团队时才校验浮动佣金
    if(param.job_code == '101' || param.job_code == '102'){
    	//必填校验(浮动佣金)
        if(validRequired_FD(fdCommissionList, obj)){
            return;
        }
    }
    //保存
    $.post(globalUtil.getTimestampUrl("/inve/saveRules.do"), param,
        function(data) {
        if (data === 'success') {
             globalUtil.successMsg(globalErrorMsg['100002'], function(){  
                 initbase(param.job_code);//重新加载列表0
             });
         } else if(data === 'errorid'){//产品存在规则
             globalUtil.errorMsg(globalErrorMsg['910022']);//选择的产品中已有存在其他规则
         } else{
             globalUtil.errorMsg(globalErrorMsg['100012']);//保存失败
         }
    });
    
}

//验证提交时必填项(外层列表)
function validRequired(param, obj){
	if(param.belonging_company == null|| param.belonging_company == "" || param.belonging_company == -1){//所属公司
        globalUtil.warnMsg(globalErrorMsg['910093']);
        return true;
    }
	if(param.category_ids == null|| param.category_ids == ""){//产品
		if(param.page_rule_sate != -1){//"请选择"状态可以不选择产品
			globalUtil.warnMsg(globalErrorMsg['910061']);//请选择规则对应的产品
	        return true;
		}
    }
}

//验证提交时必填项(上单当月给予一次性佣金)
function validRequiredYCX_One(param, obj){
    for(var i = 0; i < param.length; i++){
        if(param[i].commission_type == null || param[i].commission_type == "" || param[i].commission_type == -1){//上单当月给予一次性佣金规则
            globalUtil.warnMsg(globalErrorMsg['930006']);
            return true;
        }
        if(param[i].stock_begin == null || param[i].stock_begin == ""){//上单当月给予一次性佣金[存量限制](单位:万)起始
            globalUtil.warnMsg(globalErrorMsg['930007']);
            return true;
        }
        if(param[i].stock_end == null || param[i].stock_end == ""){//上单当月给予一次性佣金[存量限制](单位:万含)截止
            globalUtil.warnMsg(globalErrorMsg['930008']);
            return true;
        }
        //判断存量开始值是否大于截止值(允许开始值与截止值全为0)
        if(!(parseInt(param[i].stock_begin) < parseInt(param[i].stock_end))
                &&
            ((parseInt(param[i].stock_begin) != 0) && (parseInt(param[i].stock_end) != 0))){
            globalUtil.warnMsg(globalErrorMsg['930012']);
            return true;
        }
        if(param[i].base_commission == null || param[i].base_commission == ""){//基础佣金系数
            globalUtil.warnMsg(globalErrorMsg['930009']);
            return true;
        }
        //判断存量是否重复
        for(var j = (i + 1); j < param.length; j++){
            if(isInclude(param[i].stock_begin, param[j].stock_begin, param[j].stock_end, "begin")){
                globalUtil.warnMsg(globalErrorMsg['930013']);
                return true;
            }
            if(isInclude(param[i].stock_end, param[j].stock_begin, param[j].stock_end, "end")){
                globalUtil.warnMsg(globalErrorMsg['930013']);
                return true;
            }
        }
    }
}

//验证提交时必填项(上单满...个月再按照)
function validRequiredYCX_Two(param, obj){
    for(var i = 0; i < param.length; i++){
        /* if(param[i].month_count == null || param[i].month_count == ""){//上单满月数
            globalUtil.warnMsg(globalErrorMsg['930010']);
            return true;
        }
        if(param[i].base_commission == null || param[i].base_commission == ""){//基础佣金系数
            globalUtil.warnMsg(globalErrorMsg['930011']);
            return true;
        } */
        //判断月数是否重复
        for(var j = (i + 1); j < param.length; j++){
            if(param[j].month_count != "" && param[i].month_count != "" && param[j].month_count == param[i].month_count){
                globalUtil.warnMsg(globalErrorMsg['930014']);
                return true;
            }
        }
    }
}

//验证提交时必填项(一次性)
function validRequiredYCX(param, obj){
    for(var i = 0; i < param.length; i++){
    	if(param[i].commission_type == null || param[i].commission_type == "" || param[i].commission_type == -1){//一次性佣金规则
            globalUtil.warnMsg(globalErrorMsg['910064']);
            return true;
        }
    	if(param[i].stock_begin == null || param[i].stock_begin == ""){//一次性佣金[存量限制](单位:万)起始
            globalUtil.warnMsg(globalErrorMsg['910065']);
            return true;
        }
        if(param[i].stock_end == null || param[i].stock_end == ""){//一次性佣金[存量限制](单位:万含)截止
            globalUtil.warnMsg(globalErrorMsg['910066']);
            return true;
        }
        //判断存量开始值是否大于截止值(允许开始值与截止值全为0)
        if(!(parseInt(param[i].stock_begin) < parseInt(param[i].stock_end))
        		&&
        	((parseInt(param[i].stock_begin) != 0) && (parseInt(param[i].stock_end) != 0))){
            globalUtil.warnMsg(globalErrorMsg['910067']);
            return true;
        }
        if(param[i].base_commission == null || param[i].base_commission == ""){//基础佣金系数
            globalUtil.warnMsg(globalErrorMsg['910068']);
            return true;
        }
        //判断存量是否重复
        for(var j = (i + 1); j < param.length; j++){
            if(isInclude(param[i].stock_begin, param[j].stock_begin, param[j].stock_end, "begin")){
                globalUtil.warnMsg(globalErrorMsg['910069']);
                return true;
            }
            if(isInclude(param[i].stock_end, param[j].stock_begin, param[j].stock_end, "end")){
                globalUtil.warnMsg(globalErrorMsg['910069']);
                return true;
            }
        }
    }
}

//验证提交时必填项(月付佣金)
function validRequired_YF(param, obj){
    for(var i = 0; i < param.length; i++){
        if(param[i].stock_begin == null || param[i].stock_begin == ""){//月付佣金[存量限制](单位:万)起始
            globalUtil.warnMsg(globalErrorMsg['910070']);
            return true;
        }
        if(param[i].stock_end == null || param[i].stock_end == ""){//月付[存量限制](单位:万含)截止
            globalUtil.warnMsg(globalErrorMsg['910071']);
            return true;
        }
        //判断存量开始值是否大于截止值(允许开始值与截止值全为0)
        if(!(parseInt(param[i].stock_begin) < parseInt(param[i].stock_end)) 
        		&&
            ((parseInt(param[i].stock_begin) != 0) && (parseInt(param[i].stock_end) != 0))){
            globalUtil.warnMsg(globalErrorMsg['910072']);
            return true;
        }
        if(param[i].base_commission == null || param[i].base_commission == ""){//基础佣金系数
            globalUtil.warnMsg(globalErrorMsg['910073']);
            return true;
        }
        //判断存量是否重复
        for(var j = (i + 1); j < param.length; j++){
            if(isInclude(param[i].stock_begin, param[j].stock_begin, param[j].stock_end, "begin")){
                globalUtil.warnMsg(globalErrorMsg['910074']);
                return true;
            }
            if(isInclude(param[i].stock_end, param[j].stock_begin, param[j].stock_end, "end")){
                globalUtil.warnMsg(globalErrorMsg['910074']);
                return true;
            }
        }
    }
}

//验证提交时必填项(浮动佣金)
function validRequired_FD(param, obj){
    for(var i = 0; i < param.length; i++){
    	if(param[i].commission_type == null || param[i].commission_type == "" || param[i].commission_type == -1){//佣金规则
            globalUtil.warnMsg(globalErrorMsg['910075']);
            return true;
        }
        if(param[i].cumulate_begin == null || param[i].cumulate_begin == ""){//团队佣金[存量限制](单位:万)起始
            globalUtil.warnMsg(globalErrorMsg['910076']);
            return true;
        }
        if(param[i].cumulate_end == null || param[i].cumulate_end == ""){//团队[存量限制](单位:万含)截止
            globalUtil.warnMsg(globalErrorMsg['910077']);
            return true;
        }
        //判断存量开始值是否大于截止值(允许开始值与截止值全为0)
        if(!(parseInt(param[i].cumulate_begin) < parseInt(param[i].cumulate_end))
        		&&
            ((parseInt(param[i].cumulate_begin) != 0) && (parseInt(param[i].cumulate_end) != 0))){
            globalUtil.warnMsg(globalErrorMsg['910078']);
            return true;
        }
        if(param[i].floating_commission_disposable == null || param[i].floating_commission_disposable == ""){//一次性付佣金系数(%)
            globalUtil.warnMsg(globalErrorMsg['910079']);
            return true;
        }
        if(param[i].floating_commission_monthly == null || param[i].floating_commission_monthly == ""){//月付佣金系数(%)
            globalUtil.warnMsg(globalErrorMsg['910094']);
            return true;
        }
        //判断存量是否重复
        for(var j = (i + 1); j < param.length; j++){
            if(isInclude(param[i].cumulate_begin, param[j].cumulate_begin, param[j].cumulate_end, "begin")){
                globalUtil.warnMsg(globalErrorMsg['910080']);
                return true;
            }
            if(isInclude(param[i].cumulate_end, param[j].cumulate_begin, param[j].cumulate_end, "end")){
                globalUtil.warnMsg(globalErrorMsg['910080']);
                return true;
            }
        }
    }
}

//判断值是否包括在内val的值是否在valbegin和valend范围内 
function isInclude(val, valbegin, valend, opt){
    if((parseInt(val) > parseInt(valbegin)) && (parseInt(val) < parseInt(valend)) && opt == "begin"){
        return true;
    }
    if((parseInt(val) > parseInt(valbegin)) && (parseInt(val) <= parseInt(valend)) && opt == "end"){
        return true;
    }
    return false;
}

//显示所有产品
function showProducts(obj) {
    var index = $(obj).closest("tr").index();
    var vals = $(obj).closest("tr").find("input[name='wms_inve_pruduct_category_id']").val();
    var job_code_val = $(obj).closest("tr").find("input[name='job_code']").val();//职务编码
    
    var url = globalUtil.getHtml("financingProduct.html?sigleSign=1&vals=" + vals + "&index=" + index + "&sigleSign=2" +"&job_code_val=" + job_code_val);
    dialog = $.ligerDialog.open({
        url: url,
        title: '理财产品',
        width: 700,
        height: globalUtil.setDialogHeight(500),
        onHiddenOrClose: function(){
        },
        isResize: false
    });
}

//产品选择返回给产品赋值
function setCategory(index, vals, names,job_code_val) {
    if(job_code_val == job_code_kh){//客户经理
        $("#lcsqxxtablekh").find("tr:eq(" + index + ")").find("input[name='wms_inve_pruduct_category_id']").val(vals);
        $("#lcsqxxtablekh").find("tr:eq(" + index + ")").find("span.category_name").html(names);    
    }else if(job_code_val == job_code_td){//团队经理
        $("#lcsqxxtabletd").find("tr:eq(" + index + ")").find("input[name='wms_inve_pruduct_category_id']").val(vals);
        $("#lcsqxxtabletd").find("tr:eq(" + index + ")").find("span.category_name").html(names);
    }else if(job_code_val == job_code_jx){//见习经理
        $("#lcsqxxtablejx").find("tr:eq(" + index + ")").find("input[name='wms_inve_pruduct_category_id']").val(vals);
        $("#lcsqxxtablejx").find("tr:eq(" + index + ")").find("span.category_name").html(names);
    }
}

//Tab页切换
function changeTab(id) {
    var khinfo = document.getElementById("khjl"); //客户信息
    var jxinfo = document.getElementById("jxjl"); //见习经理
    var tdinfo = document.getElementById("tdjl"); //团队经理
    
    if(id == 'khjl') {
        document.getElementById("tabbody1").className = "tabbody1";
        document.getElementById("tabbody2").className = "tabbody2";     
        document.getElementById("tabbody3").className = "tabbody2";     
        document.getElementById("khtabdiv").className = "tab_step tab_step101";
        document.getElementById("jxtabdiv").className = "tab_step tab_step202";             
        document.getElementById("tdtabdiv").className = "tab_step tab_step302"; 
        khinfo.style.display = '';
        tdinfo.style.display = 'none';
        jxinfo.style.display = 'none';
    }else if (id == 'jxjl') {
        document.getElementById("tabbody1").className = "tabbody2";
        document.getElementById("tabbody2").className = "tabbody1"; 
        document.getElementById("tabbody3").className = "tabbody2";     
        document.getElementById("khtabdiv").className = "tab_step tab_step102";
        document.getElementById("jxtabdiv").className = "tab_step tab_step201"; 
        document.getElementById("tdtabdiv").className = "tab_step tab_step302"; 
        khinfo.style.display = 'none';
        tdinfo.style.display = 'none';
        jxinfo.style.display = '';
    }else if (id == 'tdjl') {
        document.getElementById("tabbody1").className = "tabbody2";
        document.getElementById("tabbody2").className = "tabbody2"; 
        document.getElementById("tabbody3").className = "tabbody1";     
        document.getElementById("khtabdiv").className = "tab_step tab_step102";
        document.getElementById("jxtabdiv").className = "tab_step tab_step202"; 
        document.getElementById("tdtabdiv").className = "tab_step tab_step301"; 
        khinfo.style.display = 'none';
        tdinfo.style.display = '';
        jxinfo.style.display = 'none';
    }
      
}

//关闭本页
function closeTab(){
    globalUtil.closeCurrentTab();//关闭当前TAB页面    
}

/*
    获取表格数据，去除全部为空的记录
*/
function getGridData(data_all){
    var griddata = [];
    for(var i = 0;i < data_all.length; i++){
        var data = data_all[i];
        var isEmpty = true;
            if(data){
                for(var key in data){
                    if($.trim(key) == '' || $.trim(key) == '__status'){
                        continue;
                    }
                    if(!globalUtil.isEmpty(data[key]) && data[key] != "-1"){
                        if(data[key] instanceof Date){
                            data[key] = data[key].format('yyyy-MM-dd');//格式化日期类型数据
                        }
                        isEmpty = false;
                    }
                }
            }
            if(!isEmpty){
                griddata.push(data);
            }
    }
    return griddata;
}

jQuery(function(){
    //表格内tab页切换
    $(document).on( 'click', '.tdTab', function(){
    	var trTabIndex = $(this).index();
    	//tab td样式切换
        $(this).addClass('tabbody1').removeClass('tabbody2').
            siblings().addClass('tabbody2').removeClass('tabbody1');
        //tr显隐
        var allTr = $(this).closest("tr").nextUntil(".hideEnd");
        allTr.each(function(i, o){
            if($(o).hasClass('trTab' + (trTabIndex + 1))){
                $(o).show();
            }else{
            	$(o).hide();
            }
        });
    });
    
    //修改select值时同步当前下拉详细列表全部select值
    $(document).on('change', 'select', function(){
    	var val = $(this).val();
    	if($(this).attr('name') != ''){
	        $(this).closest("tr").nextUntil(".noshow").find("[name='" + $(this).attr('name') + "']").val(val).attr('disabled', 'disabled');
    	}
    });
    
    //tr选中事件
    $(document).on('click', '.noshow', function(){
        $(this).siblings().removeClass('trSelected');
        if($(this).hasClass('trSelected')){
        	$(this).removeClass('trSelected');
        }else{
        	$(this).addClass('trSelected');
        }
    });
    
    //阻止tr里元素冒泡事件
    $(document).on('click', 'tr select,a', function(event){
    	event.stopPropagation();
    });
    
});

(function (original) {  
    jQuery.fn.clone = function () {  
	    var result           = original.apply(this, arguments),  
		    my_textareas     = this.find('textarea').add(this.filter('textarea')),  
		    result_textareas = result.find('textarea').add(result.filter('textarea')),  
		    my_selects       = this.find('select[name!=page_rule_state]').add(this.filter('select')),  
		    result_selects   = result.find('select').add(result.filter('select'));  
		
		for (var i = 0, l = my_textareas.length; i < l; ++i) {
			$(result_textareas[i]).val($(my_textareas[i]).val());  
		}
		for (var i = 0, l = my_selects.length;   i < l; ++i) {
			result_selects[i].selectedIndex = my_selects[i].selectedIndex;  
		}
		return result;  
    };  
}) (jQuery.fn.clone);

</script>
</body>
</html>